{"mappings":"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","sources":["node_modules/stackframe/stackframe.js","node_modules/error-stack-parser/error-stack-parser.js","node_modules/@elastic/apm-rum-core/dist/es/error-logging/stack-trace.js","node_modules/promise-polyfill/src/finally.js","node_modules/promise-polyfill/src/allSettled.js","node_modules/promise-polyfill/src/index.js","node_modules/@elastic/apm-rum-core/dist/es/common/polyfills.js","node_modules/@elastic/apm-rum-core/dist/es/common/utils.js","node_modules/@elastic/apm-rum-core/dist/es/common/url.js","node_modules/@elastic/apm-rum-core/dist/es/common/constants.js","node_modules/@elastic/apm-rum-core/dist/es/common/context.js","node_modules/@elastic/apm-rum-core/dist/es/common/truncate.js","node_modules/@elastic/apm-rum-core/dist/es/error-logging/error-logging.js","node_modules/@elastic/apm-rum-core/dist/es/common/queue.js","node_modules/@elastic/apm-rum-core/dist/es/common/ndjson.js","node_modules/@elastic/apm-rum-core/dist/es/common/patching/patch-utils.js","node_modules/@elastic/apm-rum-core/dist/es/performance-monitoring/span-base.js","node_modules/@elastic/apm-rum-core/dist/es/performance-monitoring/span.js","node_modules/@elastic/apm-rum-core/dist/es/state.js","node_modules/@elastic/apm-rum-core/dist/es/performance-monitoring/capture-navigation.js","node_modules/@elastic/apm-rum-core/dist/es/common/compress.js","node_modules/@elastic/apm-rum-core/dist/es/common/apm-server.js","node_modules/@elastic/apm-rum-core/dist/es/common/throttle.js","node_modules/@elastic/apm-rum-core/dist/es/common/event-handler.js","node_modules/@elastic/apm-rum-core/dist/es/common/config-service.js","node_modules/@elastic/apm-rum-core/dist/es/common/service-factory.js","node_modules/@elastic/apm-rum-core/dist/es/common/logging-service.js","node_modules/@elastic/apm-rum-core/dist/es/common/patching/xhr-patch.js","node_modules/@elastic/apm-rum-core/dist/es/common/patching/event-target-patch.js","node_modules/@elastic/apm-rum-core/dist/es/common/patching/index.js","node_modules/@elastic/apm-rum-core/dist/es/common/patching/fetch-patch.js","node_modules/@elastic/apm-rum-core/dist/es/common/patching/history-patch.js","node_modules/@elastic/apm-rum-core/dist/es/performance-monitoring/performance-monitoring.js","node_modules/@elastic/apm-rum-core/dist/es/performance-monitoring/breakdown.js","node_modules/@elastic/apm-rum-core/dist/es/performance-monitoring/transaction.js","node_modules/@elastic/apm-rum-core/dist/es/performance-monitoring/metrics.js","node_modules/@elastic/apm-rum-core/dist/es/performance-monitoring/transaction-service.js","node_modules/@elastic/apm-rum-core/dist/es/bootstrap.js","node_modules/@elastic/apm-rum-core/dist/es/index.js","node_modules/@elastic/apm-rum-core/dist/es/performance-monitoring/index.js","node_modules/@elastic/apm-rum-core/dist/es/error-logging/index.js","node_modules/@elastic/apm-rum/dist/es/apm-base.js","node_modules/@elastic/apm-rum-core/dist/es/common/instrument.js","node_modules/@elastic/apm-rum/dist/es/index.js","index.js"],"sourcesContent":["(function (root, factory) {\n    'use strict';\n    // Universal Module Definition (UMD) to support AMD, CommonJS/Node.js, Rhino, and browsers.\n\n    /* istanbul ignore next */\n    if (typeof define === 'function' && define.amd) {\n        define('stackframe', [], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory();\n    } else {\n        root.StackFrame = factory();\n    }\n}(this, function () {\n    'use strict';\n    function _isNumber(n) {\n        return !isNaN(parseFloat(n)) && isFinite(n);\n    }\n\n    function StackFrame(functionName, args, fileName, lineNumber, columnNumber, source) {\n        if (functionName !== undefined) {\n            this.setFunctionName(functionName);\n        }\n        if (args !== undefined) {\n            this.setArgs(args);\n        }\n        if (fileName !== undefined) {\n            this.setFileName(fileName);\n        }\n        if (lineNumber !== undefined) {\n            this.setLineNumber(lineNumber);\n        }\n        if (columnNumber !== undefined) {\n            this.setColumnNumber(columnNumber);\n        }\n        if (source !== undefined) {\n            this.setSource(source);\n        }\n    }\n\n    StackFrame.prototype = {\n        getFunctionName: function () {\n            return this.functionName;\n        },\n        setFunctionName: function (v) {\n            this.functionName = String(v);\n        },\n\n        getArgs: function () {\n            return this.args;\n        },\n        setArgs: function (v) {\n            if (Object.prototype.toString.call(v) !== '[object Array]') {\n                throw new TypeError('Args must be an Array');\n            }\n            this.args = v;\n        },\n\n        // NOTE: Property name may be misleading as it includes the path,\n        // but it somewhat mirrors V8's JavaScriptStackTraceApi\n        // https://code.google.com/p/v8/wiki/JavaScriptStackTraceApi and Gecko's\n        // http://mxr.mozilla.org/mozilla-central/source/xpcom/base/nsIException.idl#14\n        getFileName: function () {\n            return this.fileName;\n        },\n        setFileName: function (v) {\n            this.fileName = String(v);\n        },\n\n        getLineNumber: function () {\n            return this.lineNumber;\n        },\n        setLineNumber: function (v) {\n            if (!_isNumber(v)) {\n                throw new TypeError('Line Number must be a Number');\n            }\n            this.lineNumber = Number(v);\n        },\n\n        getColumnNumber: function () {\n            return this.columnNumber;\n        },\n        setColumnNumber: function (v) {\n            if (!_isNumber(v)) {\n                throw new TypeError('Column Number must be a Number');\n            }\n            this.columnNumber = Number(v);\n        },\n\n        getSource: function () {\n            return this.source;\n        },\n        setSource: function (v) {\n            this.source = String(v);\n        },\n\n        toString: function() {\n            var functionName = this.getFunctionName() || '{anonymous}';\n            var args = '(' + (this.getArgs() || []).join(',') + ')';\n            var fileName = this.getFileName() ? ('@' + this.getFileName()) : '';\n            var lineNumber = _isNumber(this.getLineNumber()) ? (':' + this.getLineNumber()) : '';\n            var columnNumber = _isNumber(this.getColumnNumber()) ? (':' + this.getColumnNumber()) : '';\n            return functionName + args + fileName + lineNumber + columnNumber;\n        }\n    };\n\n    return StackFrame;\n}));\n","(function(root, factory) {\n    'use strict';\n    // Universal Module Definition (UMD) to support AMD, CommonJS/Node.js, Rhino, and browsers.\n\n    /* istanbul ignore next */\n    if (typeof define === 'function' && define.amd) {\n        define('error-stack-parser', ['stackframe'], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('stackframe'));\n    } else {\n        root.ErrorStackParser = factory(root.StackFrame);\n    }\n}(this, function ErrorStackParser(StackFrame) {\n    'use strict';\n\n    var FIREFOX_SAFARI_STACK_REGEXP = /(^|@)\\S+\\:\\d+/;\n    var CHROME_IE_STACK_REGEXP = /^\\s*at .*(\\S+\\:\\d+|\\(native\\))/m;\n    var SAFARI_NATIVE_CODE_REGEXP = /^(eval@)?(\\[native code\\])?$/;\n\n    function _map(array, fn, thisArg) {\n        if (typeof Array.prototype.map === 'function') {\n            return array.map(fn, thisArg);\n        } else {\n            var output = new Array(array.length);\n            for (var i = 0; i < array.length; i++) {\n                output[i] = fn.call(thisArg, array[i]);\n            }\n            return output;\n        }\n    }\n\n    function _filter(array, fn, thisArg) {\n        if (typeof Array.prototype.filter === 'function') {\n            return array.filter(fn, thisArg);\n        } else {\n            var output = [];\n            for (var i = 0; i < array.length; i++) {\n                if (fn.call(thisArg, array[i])) {\n                    output.push(array[i]);\n                }\n            }\n            return output;\n        }\n    }\n\n    function _indexOf(array, target) {\n        if (typeof Array.prototype.indexOf === 'function') {\n            return array.indexOf(target);\n        } else {\n            for (var i = 0; i < array.length; i++) {\n                if (array[i] === target) {\n                    return i;\n                }\n            }\n            return -1;\n        }\n    }\n\n    return {\n        /**\n         * Given an Error object, extract the most information from it.\n         *\n         * @param {Error} error object\n         * @return {Array} of StackFrames\n         */\n        parse: function ErrorStackParser$$parse(error) {\n            if (typeof error.stacktrace !== 'undefined' || typeof error['opera#sourceloc'] !== 'undefined') {\n                return this.parseOpera(error);\n            } else if (error.stack && error.stack.match(CHROME_IE_STACK_REGEXP)) {\n                return this.parseV8OrIE(error);\n            } else if (error.stack) {\n                return this.parseFFOrSafari(error);\n            } else {\n                throw new Error('Cannot parse given Error object');\n            }\n        },\n\n        // Separate line and column numbers from a string of the form: (URI:Line:Column)\n        extractLocation: function ErrorStackParser$$extractLocation(urlLike) {\n            // Fail-fast but return locations like \"(native)\"\n            if (urlLike.indexOf(':') === -1) {\n                return [urlLike];\n            }\n\n            var regExp = /(.+?)(?:\\:(\\d+))?(?:\\:(\\d+))?$/;\n            var parts = regExp.exec(urlLike.replace(/[\\(\\)]/g, ''));\n            return [parts[1], parts[2] || undefined, parts[3] || undefined];\n        },\n\n        parseV8OrIE: function ErrorStackParser$$parseV8OrIE(error) {\n            var filtered = _filter(error.stack.split('\\n'), function(line) {\n                return !!line.match(CHROME_IE_STACK_REGEXP);\n            }, this);\n\n            return _map(filtered, function(line) {\n                if (line.indexOf('(eval ') > -1) {\n                    // Throw away eval information until we implement stacktrace.js/stackframe#8\n                    line = line.replace(/eval code/g, 'eval').replace(/(\\(eval at [^\\()]*)|(\\)\\,.*$)/g, '');\n                }\n                var tokens = line.replace(/^\\s+/, '').replace(/\\(eval code/g, '(').split(/\\s+/).slice(1);\n                var locationParts = this.extractLocation(tokens.pop());\n                var functionName = tokens.join(' ') || undefined;\n                var fileName = _indexOf(['eval', '<anonymous>'], locationParts[0]) > -1 ? undefined : locationParts[0];\n\n                return new StackFrame(functionName, undefined, fileName, locationParts[1], locationParts[2], line);\n            }, this);\n        },\n\n        parseFFOrSafari: function ErrorStackParser$$parseFFOrSafari(error) {\n            var filtered = _filter(error.stack.split('\\n'), function(line) {\n                return !line.match(SAFARI_NATIVE_CODE_REGEXP);\n            }, this);\n\n            return _map(filtered, function(line) {\n                // Throw away eval information until we implement stacktrace.js/stackframe#8\n                if (line.indexOf(' > eval') > -1) {\n                    line = line.replace(/ line (\\d+)(?: > eval line \\d+)* > eval\\:\\d+\\:\\d+/g, ':$1');\n                }\n\n                if (line.indexOf('@') === -1 && line.indexOf(':') === -1) {\n                    // Safari eval frames only have function names and nothing else\n                    return new StackFrame(line);\n                } else {\n                    var tokens = line.split('@');\n                    var locationParts = this.extractLocation(tokens.pop());\n                    var functionName = tokens.join('@') || undefined;\n                    return new StackFrame(functionName,\n                        undefined,\n                        locationParts[0],\n                        locationParts[1],\n                        locationParts[2],\n                        line);\n                }\n            }, this);\n        },\n\n        parseOpera: function ErrorStackParser$$parseOpera(e) {\n            if (!e.stacktrace || (e.message.indexOf('\\n') > -1 &&\n                e.message.split('\\n').length > e.stacktrace.split('\\n').length)) {\n                return this.parseOpera9(e);\n            } else if (!e.stack) {\n                return this.parseOpera10(e);\n            } else {\n                return this.parseOpera11(e);\n            }\n        },\n\n        parseOpera9: function ErrorStackParser$$parseOpera9(e) {\n            var lineRE = /Line (\\d+).*script (?:in )?(\\S+)/i;\n            var lines = e.message.split('\\n');\n            var result = [];\n\n            for (var i = 2, len = lines.length; i < len; i += 2) {\n                var match = lineRE.exec(lines[i]);\n                if (match) {\n                    result.push(new StackFrame(undefined, undefined, match[2], match[1], undefined, lines[i]));\n                }\n            }\n\n            return result;\n        },\n\n        parseOpera10: function ErrorStackParser$$parseOpera10(e) {\n            var lineRE = /Line (\\d+).*script (?:in )?(\\S+)(?:: In function (\\S+))?$/i;\n            var lines = e.stacktrace.split('\\n');\n            var result = [];\n\n            for (var i = 0, len = lines.length; i < len; i += 2) {\n                var match = lineRE.exec(lines[i]);\n                if (match) {\n                    result.push(\n                        new StackFrame(\n                            match[3] || undefined,\n                            undefined,\n                            match[2],\n                            match[1],\n                            undefined,\n                            lines[i]\n                        )\n                    );\n                }\n            }\n\n            return result;\n        },\n\n        // Opera 10.65+ Error.stack very similar to FF/Safari\n        parseOpera11: function ErrorStackParser$$parseOpera11(error) {\n            var filtered = _filter(error.stack.split('\\n'), function(line) {\n                return !!line.match(FIREFOX_SAFARI_STACK_REGEXP) && !line.match(/^Error created at/);\n            }, this);\n\n            return _map(filtered, function(line) {\n                var tokens = line.split('@');\n                var locationParts = this.extractLocation(tokens.pop());\n                var functionCall = (tokens.shift() || '');\n                var functionName = functionCall\n                        .replace(/<anonymous function(: (\\w+))?>/, '$2')\n                        .replace(/\\([^\\)]*\\)/g, '') || undefined;\n                var argsRaw;\n                if (functionCall.match(/\\(([^\\)]*)\\)/)) {\n                    argsRaw = functionCall.replace(/^[^\\(]+\\(([^\\)]*)\\)$/, '$1');\n                }\n                var args = (argsRaw === undefined || argsRaw === '[arguments not available]') ?\n                    undefined : argsRaw.split(',');\n                return new StackFrame(\n                    functionName,\n                    args,\n                    locationParts[0],\n                    locationParts[1],\n                    locationParts[2],\n                    line);\n            }, this);\n        }\n    };\n}));\n\n","import stackParser from 'error-stack-parser';\n\nfunction filePathToFileName(fileUrl) {\n  var origin = window.location.origin || window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');\n\n  if (fileUrl.indexOf(origin) > -1) {\n    fileUrl = fileUrl.replace(origin + '/', '');\n  }\n\n  return fileUrl;\n}\n\nfunction cleanFilePath(filePath) {\n  if (filePath === void 0) {\n    filePath = '';\n  }\n\n  if (filePath === '<anonymous>') {\n    filePath = '';\n  }\n\n  return filePath;\n}\n\nfunction isFileInline(fileUrl) {\n  if (fileUrl) {\n    return window.location.href.indexOf(fileUrl) === 0;\n  }\n\n  return false;\n}\n\nfunction normalizeStackFrames(stackFrames) {\n  return stackFrames.map(function (frame) {\n    if (frame.functionName) {\n      frame.functionName = normalizeFunctionName(frame.functionName);\n    }\n\n    return frame;\n  });\n}\n\nfunction normalizeFunctionName(fnName) {\n  var parts = fnName.split('/');\n\n  if (parts.length > 1) {\n    fnName = ['Object', parts[parts.length - 1]].join('.');\n  } else {\n    fnName = parts[0];\n  }\n\n  fnName = fnName.replace(/.<$/gi, '.<anonymous>');\n  fnName = fnName.replace(/^Anonymous function$/, '<anonymous>');\n  parts = fnName.split('.');\n\n  if (parts.length > 1) {\n    fnName = parts[parts.length - 1];\n  } else {\n    fnName = parts[0];\n  }\n\n  return fnName;\n}\n\nexport function createStackTraces(errorEvent) {\n  var error = errorEvent.error,\n      filename = errorEvent.filename,\n      lineno = errorEvent.lineno,\n      colno = errorEvent.colno;\n  var stackTraces = [];\n\n  if (error) {\n    try {\n      stackTraces = stackParser.parse(error);\n    } catch (e) {}\n  }\n\n  if (stackTraces.length === 0) {\n    stackTraces = [{\n      fileName: filename,\n      lineNumber: lineno,\n      columnNumber: colno\n    }];\n  }\n\n  var normalizedStackTraces = normalizeStackFrames(stackTraces);\n  return normalizedStackTraces.map(function (stack) {\n    var fileName = stack.fileName,\n        lineNumber = stack.lineNumber,\n        columnNumber = stack.columnNumber,\n        _stack$functionName = stack.functionName,\n        functionName = _stack$functionName === void 0 ? '<anonymous>' : _stack$functionName;\n\n    if (!fileName && !lineNumber) {\n      return {};\n    }\n\n    if (!columnNumber && !lineNumber) {\n      return {};\n    }\n\n    var filePath = cleanFilePath(fileName);\n    var cleanedFileName = filePathToFileName(filePath);\n\n    if (isFileInline(filePath)) {\n      cleanedFileName = '(inline script)';\n    }\n\n    return {\n      abs_path: fileName,\n      filename: cleanedFileName,\n      function: functionName,\n      lineno: lineNumber,\n      colno: columnNumber\n    };\n  });\n}\nexport function filterInvalidFrames(frames) {\n  return frames.filter(function (_ref) {\n    var filename = _ref.filename,\n        lineno = _ref.lineno;\n    return typeof filename !== 'undefined' && typeof lineno !== 'undefined';\n  });\n}","/**\n * @this {Promise}\n */\nfunction finallyConstructor(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      // @ts-ignore\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      // @ts-ignore\n      return constructor.resolve(callback()).then(function() {\n        // @ts-ignore\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nexport default finallyConstructor;\n","function allSettled(arr) {\n  var P = this;\n  return new P(function(resolve, reject) {\n    if (!(arr && typeof arr.length !== 'undefined')) {\n      return reject(\n        new TypeError(\n          typeof arr +\n            ' ' +\n            arr +\n            ' is not iterable(cannot read property Symbol(Symbol.iterator))'\n        )\n      );\n    }\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      if (val && (typeof val === 'object' || typeof val === 'function')) {\n        var then = val.then;\n        if (typeof then === 'function') {\n          then.call(\n            val,\n            function(val) {\n              res(i, val);\n            },\n            function(e) {\n              args[i] = { status: 'rejected', reason: e };\n              if (--remaining === 0) {\n                resolve(args);\n              }\n            }\n          );\n          return;\n        }\n      }\n      args[i] = { status: 'fulfilled', value: val };\n      if (--remaining === 0) {\n        resolve(args);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n}\n\nexport default allSettled;\n","import promiseFinally from './finally';\nimport allSettled from './allSettled';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction isArray(x) {\n  return Boolean(x && typeof x.length !== 'undefined');\n}\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!isArray(arr)) {\n      return reject(new TypeError('Promise.all accepts an array'));\n    }\n\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.allSettled = allSettled;\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!isArray(arr)) {\n      return reject(new TypeError('Promise.race accepts an array'));\n    }\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      Promise.resolve(arr[i]).then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  // @ts-ignore\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      // @ts-ignore\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nexport default Promise;\n","import PromisePollyfill from 'promise-polyfill';\nimport { isBrowser } from './utils';\nvar local = {};\n\nif (isBrowser) {\n  local = window;\n} else if (typeof self !== 'undefined') {\n  local = self;\n}\n\nvar Promise = 'Promise' in local ? local.Promise : PromisePollyfill;\nexport { Promise };","import { Promise } from './polyfills';\nvar slice = [].slice;\nvar isBrowser = typeof window !== 'undefined';\nvar PERF = isBrowser && typeof performance !== 'undefined' ? performance : {};\n\nfunction isCORSSupported() {\n  var xhr = new window.XMLHttpRequest();\n  return 'withCredentials' in xhr;\n}\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToHex(buffer) {\n  var hexOctets = [];\n\n  for (var _i = 0; _i < buffer.length; _i++) {\n    hexOctets.push(byteToHex[buffer[_i]]);\n  }\n\n  return hexOctets.join('');\n}\n\nvar destination = new Uint8Array(16);\n\nfunction rng() {\n  if (typeof crypto != 'undefined' && typeof crypto.getRandomValues == 'function') {\n    return crypto.getRandomValues(destination);\n  } else if (typeof msCrypto != 'undefined' && typeof msCrypto.getRandomValues == 'function') {\n    return msCrypto.getRandomValues(destination);\n  }\n\n  return destination;\n}\n\nfunction generateRandomId(length) {\n  var id = bytesToHex(rng());\n  return id.substr(0, length);\n}\n\nfunction getDtHeaderValue(span) {\n  var dtVersion = '00';\n  var dtUnSampledFlags = '00';\n  var dtSampledFlags = '01';\n\n  if (span && span.traceId && span.id && span.parentId) {\n    var flags = span.sampled ? dtSampledFlags : dtUnSampledFlags;\n    var id = span.sampled ? span.id : span.parentId;\n    return dtVersion + '-' + span.traceId + '-' + id + '-' + flags;\n  }\n}\n\nfunction parseDtHeaderValue(value) {\n  var parsed = /^([\\da-f]{2})-([\\da-f]{32})-([\\da-f]{16})-([\\da-f]{2})$/.exec(value);\n\n  if (parsed) {\n    var flags = parsed[4];\n    var sampled = flags !== '00';\n    return {\n      traceId: parsed[2],\n      id: parsed[3],\n      sampled: sampled\n    };\n  }\n}\n\nfunction isDtHeaderValid(header) {\n  return /^[\\da-f]{2}-[\\da-f]{32}-[\\da-f]{16}-[\\da-f]{2}$/.test(header) && header.slice(3, 35) !== '00000000000000000000000000000000' && header.slice(36, 52) !== '0000000000000000';\n}\n\nfunction getTSHeaderValue(_ref) {\n  var sampleRate = _ref.sampleRate;\n\n  if (typeof sampleRate !== 'number' || String(sampleRate).length > 256) {\n    return;\n  }\n\n  var NAMESPACE = 'es';\n  var SEPARATOR = '=';\n  return \"\" + NAMESPACE + SEPARATOR + \"s:\" + sampleRate;\n}\n\nfunction setRequestHeader(target, name, value) {\n  if (typeof target.setRequestHeader === 'function') {\n    target.setRequestHeader(name, value);\n  } else if (target.headers && typeof target.headers.append === 'function') {\n    target.headers.append(name, value);\n  } else {\n    target[name] = value;\n  }\n}\n\nfunction checkSameOrigin(source, target) {\n  var isSame = false;\n\n  if (typeof target === 'string') {\n    isSame = source === target;\n  } else if (target && typeof target.test === 'function') {\n    isSame = target.test(source);\n  } else if (Array.isArray(target)) {\n    target.forEach(function (t) {\n      if (!isSame) {\n        isSame = checkSameOrigin(source, t);\n      }\n    });\n  }\n\n  return isSame;\n}\n\nfunction isPlatformSupported() {\n  return isBrowser && typeof Set === 'function' && typeof JSON.stringify === 'function' && PERF && typeof PERF.now === 'function' && isCORSSupported();\n}\n\nfunction setLabel(key, value, obj) {\n  if (!obj || !key) return;\n  var skey = removeInvalidChars(key);\n  var valueType = typeof value;\n\n  if (value != undefined && valueType !== 'boolean' && valueType !== 'number') {\n    value = String(value);\n  }\n\n  obj[skey] = value;\n  return obj;\n}\n\nfunction getServerTimingInfo(serverTimingEntries) {\n  if (serverTimingEntries === void 0) {\n    serverTimingEntries = [];\n  }\n\n  var serverTimingInfo = [];\n  var entrySeparator = ', ';\n  var valueSeparator = ';';\n\n  for (var _i2 = 0; _i2 < serverTimingEntries.length; _i2++) {\n    var _serverTimingEntries$ = serverTimingEntries[_i2],\n        name = _serverTimingEntries$.name,\n        duration = _serverTimingEntries$.duration,\n        description = _serverTimingEntries$.description;\n    var timingValue = name;\n\n    if (description) {\n      timingValue += valueSeparator + 'desc=' + description;\n    }\n\n    if (duration) {\n      timingValue += valueSeparator + 'dur=' + duration;\n    }\n\n    serverTimingInfo.push(timingValue);\n  }\n\n  return serverTimingInfo.join(entrySeparator);\n}\n\nfunction getTimeOrigin() {\n  return PERF.timing.fetchStart;\n}\n\nfunction stripQueryStringFromUrl(url) {\n  return url && url.split('?')[0];\n}\n\nfunction isObject(value) {\n  return value !== null && typeof value === 'object';\n}\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n\nfunction baseExtend(dst, objs, deep) {\n  for (var i = 0, ii = objs.length; i < ii; ++i) {\n    var obj = objs[i];\n    if (!isObject(obj) && !isFunction(obj)) continue;\n    var keys = Object.keys(obj);\n\n    for (var j = 0, jj = keys.length; j < jj; j++) {\n      var key = keys[j];\n      var src = obj[key];\n\n      if (deep && isObject(src)) {\n        if (!isObject(dst[key])) dst[key] = Array.isArray(src) ? [] : {};\n        baseExtend(dst[key], [src], false);\n      } else {\n        dst[key] = src;\n      }\n    }\n  }\n\n  return dst;\n}\n\nfunction getElasticScript() {\n  if (typeof document !== 'undefined') {\n    var scripts = document.getElementsByTagName('script');\n\n    for (var i = 0, l = scripts.length; i < l; i++) {\n      var sc = scripts[i];\n\n      if (sc.src.indexOf('elastic') > 0) {\n        return sc;\n      }\n    }\n  }\n}\n\nfunction getCurrentScript() {\n  if (typeof document !== 'undefined') {\n    var currentScript = document.currentScript;\n\n    if (!currentScript) {\n      return getElasticScript();\n    }\n\n    return currentScript;\n  }\n}\n\nfunction extend(dst) {\n  return baseExtend(dst, slice.call(arguments, 1), false);\n}\n\nfunction merge(dst) {\n  return baseExtend(dst, slice.call(arguments, 1), true);\n}\n\nfunction isUndefined(obj) {\n  return typeof obj === 'undefined';\n}\n\nfunction noop() {}\n\nfunction find(array, predicate, thisArg) {\n  if (array == null) {\n    throw new TypeError('array is null or not defined');\n  }\n\n  var o = Object(array);\n  var len = o.length >>> 0;\n\n  if (typeof predicate !== 'function') {\n    throw new TypeError('predicate must be a function');\n  }\n\n  var k = 0;\n\n  while (k < len) {\n    var kValue = o[k];\n\n    if (predicate.call(thisArg, kValue, k, o)) {\n      return kValue;\n    }\n\n    k++;\n  }\n\n  return undefined;\n}\n\nfunction removeInvalidChars(key) {\n  return key.replace(/[.*\"]/g, '_');\n}\n\nfunction getLatestNonXHRSpan(spans) {\n  var latestSpan = null;\n\n  for (var _i3 = 0; _i3 < spans.length; _i3++) {\n    var span = spans[_i3];\n\n    if (String(span.type).indexOf('external') === -1 && (!latestSpan || latestSpan._end < span._end)) {\n      latestSpan = span;\n    }\n  }\n\n  return latestSpan;\n}\n\nfunction getEarliestSpan(spans) {\n  var earliestSpan = spans[0];\n\n  for (var _i4 = 1; _i4 < spans.length; _i4++) {\n    var span = spans[_i4];\n\n    if (earliestSpan._start > span._start) {\n      earliestSpan = span;\n    }\n  }\n\n  return earliestSpan;\n}\n\nfunction now() {\n  return PERF.now();\n}\n\nfunction getTime(time) {\n  return typeof time === 'number' && time >= 0 ? time : now();\n}\n\nfunction getDuration(start, end) {\n  if (isUndefined(end) || isUndefined(start)) {\n    return null;\n  }\n\n  return parseInt(end - start);\n}\n\nfunction scheduleMacroTask(callback) {\n  setTimeout(callback, 0);\n}\n\nfunction scheduleMicroTask(callback) {\n  Promise.resolve().then(callback);\n}\n\nfunction isPerfTimelineSupported() {\n  return typeof PERF.getEntriesByType === 'function';\n}\n\nfunction isPerfTypeSupported(type) {\n  return typeof PerformanceObserver !== 'undefined' && PerformanceObserver.supportedEntryTypes && PerformanceObserver.supportedEntryTypes.indexOf(type) >= 0;\n}\n\nexport { extend, merge, isUndefined, noop, baseExtend, bytesToHex, isCORSSupported, isObject, isFunction, isPlatformSupported, isDtHeaderValid, parseDtHeaderValue, getServerTimingInfo, getDtHeaderValue, getTSHeaderValue, getCurrentScript, getElasticScript, getTimeOrigin, generateRandomId, getEarliestSpan, getLatestNonXHRSpan, getDuration, getTime, now, rng, checkSameOrigin, scheduleMacroTask, scheduleMicroTask, setLabel, setRequestHeader, stripQueryStringFromUrl, find, removeInvalidChars, PERF, isPerfTimelineSupported, isBrowser, isPerfTypeSupported };","import { isBrowser } from './utils';\n\nfunction isDefaultPort(port, protocol) {\n  switch (protocol) {\n    case 'http:':\n      return port === '80';\n\n    case 'https:':\n      return port === '443';\n  }\n\n  return true;\n}\n\nvar RULES = [['#', 'hash'], ['?', 'query'], ['/', 'path'], ['@', 'auth', 1], [NaN, 'host', undefined, 1]];\nvar PROTOCOL_REGEX = /^([a-z][a-z0-9.+-]*:)?(\\/\\/)?([\\S\\s]*)/i;\nexport var Url = function () {\n  function Url(url) {\n    var _this$extractProtocol = this.extractProtocol(url || ''),\n        protocol = _this$extractProtocol.protocol,\n        address = _this$extractProtocol.address,\n        slashes = _this$extractProtocol.slashes;\n\n    var relative = !protocol && !slashes;\n    var location = this.getLocation();\n    var instructions = RULES.slice();\n    address = address.replace('\\\\', '/');\n\n    if (!slashes) {\n      instructions[2] = [NaN, 'path'];\n    }\n\n    var index;\n\n    for (var i = 0; i < instructions.length; i++) {\n      var instruction = instructions[i];\n      var parse = instruction[0];\n      var key = instruction[1];\n\n      if (typeof parse === 'string') {\n        index = address.indexOf(parse);\n\n        if (~index) {\n          var instLength = instruction[2];\n\n          if (instLength) {\n            var newIndex = address.lastIndexOf(parse);\n            index = Math.max(index, newIndex);\n            this[key] = address.slice(0, index);\n            address = address.slice(index + instLength);\n          } else {\n            this[key] = address.slice(index);\n            address = address.slice(0, index);\n          }\n        }\n      } else {\n        this[key] = address;\n        address = '';\n      }\n\n      this[key] = this[key] || (relative && instruction[3] ? location[key] || '' : '');\n      if (instruction[3]) this[key] = this[key].toLowerCase();\n    }\n\n    if (relative && this.path.charAt(0) !== '/') {\n      this.path = '/' + this.path;\n    }\n\n    this.relative = relative;\n    this.protocol = protocol || location.protocol;\n    this.hostname = this.host;\n    this.port = '';\n\n    if (/:\\d+$/.test(this.host)) {\n      var value = this.host.split(':');\n      var port = value.pop();\n      var hostname = value.join(':');\n\n      if (isDefaultPort(port, this.protocol)) {\n        this.host = hostname;\n      } else {\n        this.port = port;\n      }\n\n      this.hostname = hostname;\n    }\n\n    this.origin = this.protocol && this.host && this.protocol !== 'file:' ? this.protocol + '//' + this.host : 'null';\n    this.href = this.toString();\n  }\n\n  var _proto = Url.prototype;\n\n  _proto.toString = function toString() {\n    var result = this.protocol;\n    result += '//';\n\n    if (this.auth) {\n      var REDACTED = '[REDACTED]';\n      var userpass = this.auth.split(':');\n      var username = userpass[0] ? REDACTED : '';\n      var password = userpass[1] ? ':' + REDACTED : '';\n      result += username + password + '@';\n    }\n\n    result += this.host;\n    result += this.path;\n    result += this.query;\n    result += this.hash;\n    return result;\n  };\n\n  _proto.getLocation = function getLocation() {\n    var globalVar = {};\n\n    if (isBrowser) {\n      globalVar = window;\n    }\n\n    return globalVar.location;\n  };\n\n  _proto.extractProtocol = function extractProtocol(url) {\n    var match = PROTOCOL_REGEX.exec(url);\n    return {\n      protocol: match[1] ? match[1].toLowerCase() : '',\n      slashes: !!match[2],\n      address: match[3]\n    };\n  };\n\n  return Url;\n}();\nexport function slugifyUrl(urlStr, depth) {\n  if (depth === void 0) {\n    depth = 2;\n  }\n\n  var parsedUrl = new Url(urlStr);\n  var query = parsedUrl.query,\n      path = parsedUrl.path;\n  var pathParts = path.substring(1).split('/');\n  var redactString = ':id';\n  var wildcard = '*';\n  var specialCharsRegex = /\\W|_/g;\n  var digitsRegex = /[0-9]/g;\n  var lowerCaseRegex = /[a-z]/g;\n  var upperCaseRegex = /[A-Z]/g;\n  var redactedParts = [];\n  var redactedBefore = false;\n\n  for (var index = 0; index < pathParts.length; index++) {\n    var part = pathParts[index];\n\n    if (redactedBefore || index > depth - 1) {\n      if (part) {\n        redactedParts.push(wildcard);\n      }\n\n      break;\n    }\n\n    var numberOfSpecialChars = (part.match(specialCharsRegex) || []).length;\n\n    if (numberOfSpecialChars >= 2) {\n      redactedParts.push(redactString);\n      redactedBefore = true;\n      continue;\n    }\n\n    var numberOfDigits = (part.match(digitsRegex) || []).length;\n\n    if (numberOfDigits > 3 || part.length > 3 && numberOfDigits / part.length >= 0.3) {\n      redactedParts.push(redactString);\n      redactedBefore = true;\n      continue;\n    }\n\n    var numberofUpperCase = (part.match(upperCaseRegex) || []).length;\n    var numberofLowerCase = (part.match(lowerCaseRegex) || []).length;\n    var lowerCaseRate = numberofLowerCase / part.length;\n    var upperCaseRate = numberofUpperCase / part.length;\n\n    if (part.length > 5 && (upperCaseRate > 0.3 && upperCaseRate < 0.6 || lowerCaseRate > 0.3 && lowerCaseRate < 0.6)) {\n      redactedParts.push(redactString);\n      redactedBefore = true;\n      continue;\n    }\n\n    part && redactedParts.push(part);\n  }\n\n  var redacted = '/' + (redactedParts.length >= 2 ? redactedParts.join('/') : redactedParts.join('')) + (query ? '?{query}' : '');\n  return redacted;\n}","var SCHEDULE = 'schedule';\nvar INVOKE = 'invoke';\nvar ADD_EVENT_LISTENER_STR = 'addEventListener';\nvar REMOVE_EVENT_LISTENER_STR = 'removeEventListener';\nvar RESOURCE_INITIATOR_TYPES = ['link', 'css', 'script', 'img', 'xmlhttprequest', 'fetch', 'beacon', 'iframe'];\nvar REUSABILITY_THRESHOLD = 5000;\nvar MAX_SPAN_DURATION = 5 * 60 * 1000;\nvar PAGE_LOAD = 'page-load';\nvar ROUTE_CHANGE = 'route-change';\nvar TYPE_CUSTOM = 'custom';\nvar USER_INTERACTION = 'user-interaction';\nvar HTTP_REQUEST_TYPE = 'http-request';\nvar TEMPORARY_TYPE = 'temporary';\nvar NAME_UNKNOWN = 'Unknown';\nvar TRANSACTION_TYPE_ORDER = [PAGE_LOAD, ROUTE_CHANGE, USER_INTERACTION, HTTP_REQUEST_TYPE, TYPE_CUSTOM, TEMPORARY_TYPE];\nvar OUTCOME_SUCCESS = 'success';\nvar OUTCOME_FAILURE = 'failure';\nvar USER_TIMING_THRESHOLD = 60;\nvar TRANSACTION_START = 'transaction:start';\nvar TRANSACTION_END = 'transaction:end';\nvar CONFIG_CHANGE = 'config:change';\nvar XMLHTTPREQUEST = 'xmlhttprequest';\nvar FETCH = 'fetch';\nvar HISTORY = 'history';\nvar EVENT_TARGET = 'eventtarget';\nvar ERROR = 'error';\nvar BEFORE_EVENT = ':before';\nvar AFTER_EVENT = ':after';\nvar LOCAL_CONFIG_KEY = 'elastic_apm_config';\nvar LONG_TASK = 'longtask';\nvar PAINT = 'paint';\nvar MEASURE = 'measure';\nvar NAVIGATION = 'navigation';\nvar RESOURCE = 'resource';\nvar FIRST_CONTENTFUL_PAINT = 'first-contentful-paint';\nvar LARGEST_CONTENTFUL_PAINT = 'largest-contentful-paint';\nvar FIRST_INPUT = 'first-input';\nvar LAYOUT_SHIFT = 'layout-shift';\nvar ERRORS = 'errors';\nvar TRANSACTIONS = 'transactions';\nvar CONFIG_SERVICE = 'ConfigService';\nvar LOGGING_SERVICE = 'LoggingService';\nvar APM_SERVER = 'ApmServer';\nvar TRUNCATED_TYPE = '.truncated';\nvar KEYWORD_LIMIT = 1024;\nvar SESSION_TIMEOUT = 30 * 60000;\nexport { SCHEDULE, INVOKE, ADD_EVENT_LISTENER_STR, REMOVE_EVENT_LISTENER_STR, RESOURCE_INITIATOR_TYPES, REUSABILITY_THRESHOLD, MAX_SPAN_DURATION, PAGE_LOAD, ROUTE_CHANGE, NAME_UNKNOWN, TYPE_CUSTOM, USER_TIMING_THRESHOLD, TRANSACTION_START, TRANSACTION_END, CONFIG_CHANGE, XMLHTTPREQUEST, FETCH, HISTORY, EVENT_TARGET, ERROR, BEFORE_EVENT, AFTER_EVENT, LOCAL_CONFIG_KEY, HTTP_REQUEST_TYPE, LONG_TASK, PAINT, MEASURE, NAVIGATION, RESOURCE, FIRST_CONTENTFUL_PAINT, LARGEST_CONTENTFUL_PAINT, KEYWORD_LIMIT, TEMPORARY_TYPE, USER_INTERACTION, TRANSACTION_TYPE_ORDER, ERRORS, TRANSACTIONS, CONFIG_SERVICE, LOGGING_SERVICE, APM_SERVER, TRUNCATED_TYPE, FIRST_INPUT, LAYOUT_SHIFT, OUTCOME_SUCCESS, OUTCOME_FAILURE, SESSION_TIMEOUT };","var _excluded = [\"tags\"];\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport { Url } from './url';\nimport { PAGE_LOAD, NAVIGATION } from './constants';\nimport { getServerTimingInfo, PERF, isPerfTimelineSupported } from './utils';\nvar LEFT_SQUARE_BRACKET = 91;\nvar RIGHT_SQUARE_BRACKET = 93;\nvar EXTERNAL = 'external';\nvar RESOURCE = 'resource';\nvar HARD_NAVIGATION = 'hard-navigation';\n\nfunction getPortNumber(port, protocol) {\n  if (port === '') {\n    port = protocol === 'http:' ? '80' : protocol === 'https:' ? '443' : '';\n  }\n\n  return port;\n}\n\nfunction getResponseContext(perfTimingEntry) {\n  var transferSize = perfTimingEntry.transferSize,\n      encodedBodySize = perfTimingEntry.encodedBodySize,\n      decodedBodySize = perfTimingEntry.decodedBodySize,\n      serverTiming = perfTimingEntry.serverTiming;\n  var respContext = {\n    transfer_size: transferSize,\n    encoded_body_size: encodedBodySize,\n    decoded_body_size: decodedBodySize\n  };\n  var serverTimingStr = getServerTimingInfo(serverTiming);\n\n  if (serverTimingStr) {\n    respContext.headers = {\n      'server-timing': serverTimingStr\n    };\n  }\n\n  return respContext;\n}\n\nfunction getDestination(parsedUrl) {\n  var port = parsedUrl.port,\n      protocol = parsedUrl.protocol,\n      hostname = parsedUrl.hostname;\n  var portNumber = getPortNumber(port, protocol);\n  var ipv6Hostname = hostname.charCodeAt(0) === LEFT_SQUARE_BRACKET && hostname.charCodeAt(hostname.length - 1) === RIGHT_SQUARE_BRACKET;\n  var address = hostname;\n\n  if (ipv6Hostname) {\n    address = hostname.slice(1, -1);\n  }\n\n  return {\n    service: {\n      resource: hostname + ':' + portNumber,\n      name: '',\n      type: ''\n    },\n    address: address,\n    port: Number(portNumber)\n  };\n}\n\nfunction getResourceContext(data) {\n  var entry = data.entry,\n      url = data.url;\n  var parsedUrl = new Url(url);\n  var destination = getDestination(parsedUrl);\n  return {\n    http: {\n      url: url,\n      response: getResponseContext(entry)\n    },\n    destination: destination\n  };\n}\n\nfunction getExternalContext(data) {\n  var url = data.url,\n      method = data.method,\n      target = data.target,\n      response = data.response;\n  var parsedUrl = new Url(url);\n  var destination = getDestination(parsedUrl);\n  var context = {\n    http: {\n      method: method,\n      url: parsedUrl.href\n    },\n    destination: destination\n  };\n  var statusCode;\n\n  if (target && typeof target.status !== 'undefined') {\n    statusCode = target.status;\n  } else if (response) {\n    statusCode = response.status;\n  }\n\n  context.http.status_code = statusCode;\n  return context;\n}\n\nfunction getNavigationContext(data) {\n  var url = data.url;\n  var parsedUrl = new Url(url);\n  var destination = getDestination(parsedUrl);\n  return {\n    destination: destination\n  };\n}\n\nexport function getPageContext() {\n  return {\n    page: {\n      referer: document.referrer,\n      url: location.href\n    }\n  };\n}\nexport function addSpanContext(span, data) {\n  if (!data) {\n    return;\n  }\n\n  var type = span.type;\n  var context;\n\n  switch (type) {\n    case EXTERNAL:\n      context = getExternalContext(data);\n      break;\n\n    case RESOURCE:\n      context = getResourceContext(data);\n      break;\n\n    case HARD_NAVIGATION:\n      context = getNavigationContext(data);\n      break;\n  }\n\n  span.addContext(context);\n}\nexport function addTransactionContext(transaction, _temp) {\n  var _ref = _temp === void 0 ? {} : _temp,\n      tags = _ref.tags,\n      configContext = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  var pageContext = getPageContext();\n  var responseContext = {};\n\n  if (transaction.type === PAGE_LOAD && isPerfTimelineSupported()) {\n    var entries = PERF.getEntriesByType(NAVIGATION);\n\n    if (entries && entries.length > 0) {\n      responseContext = {\n        response: getResponseContext(entries[0])\n      };\n    }\n  }\n\n  transaction.addContext(pageContext, responseContext, configContext);\n}","import { KEYWORD_LIMIT } from './constants';\nvar METADATA_MODEL = {\n  service: {\n    name: [KEYWORD_LIMIT, true],\n    version: true,\n    agent: {\n      version: [KEYWORD_LIMIT, true]\n    },\n    environment: true\n  },\n  labels: {\n    '*': true\n  }\n};\nvar RESPONSE_MODEL = {\n  '*': true,\n  headers: {\n    '*': true\n  }\n};\nvar DESTINATION_MODEL = {\n  address: [KEYWORD_LIMIT],\n  service: {\n    '*': [KEYWORD_LIMIT, true]\n  }\n};\nvar CONTEXT_MODEL = {\n  user: {\n    id: true,\n    email: true,\n    username: true\n  },\n  tags: {\n    '*': true\n  },\n  http: {\n    response: RESPONSE_MODEL\n  },\n  destination: DESTINATION_MODEL,\n  response: RESPONSE_MODEL\n};\nvar SPAN_MODEL = {\n  name: [KEYWORD_LIMIT, true],\n  type: [KEYWORD_LIMIT, true],\n  id: [KEYWORD_LIMIT, true],\n  trace_id: [KEYWORD_LIMIT, true],\n  parent_id: [KEYWORD_LIMIT, true],\n  transaction_id: [KEYWORD_LIMIT, true],\n  subtype: true,\n  action: true,\n  context: CONTEXT_MODEL\n};\nvar TRANSACTION_MODEL = {\n  name: true,\n  parent_id: true,\n  type: [KEYWORD_LIMIT, true],\n  id: [KEYWORD_LIMIT, true],\n  trace_id: [KEYWORD_LIMIT, true],\n  span_count: {\n    started: [KEYWORD_LIMIT, true]\n  },\n  context: CONTEXT_MODEL\n};\nvar ERROR_MODEL = {\n  id: [KEYWORD_LIMIT, true],\n  trace_id: true,\n  transaction_id: true,\n  parent_id: true,\n  culprit: true,\n  exception: {\n    type: true\n  },\n  transaction: {\n    type: true\n  },\n  context: CONTEXT_MODEL\n};\n\nfunction truncate(value, limit, required, placeholder) {\n  if (limit === void 0) {\n    limit = KEYWORD_LIMIT;\n  }\n\n  if (required === void 0) {\n    required = false;\n  }\n\n  if (placeholder === void 0) {\n    placeholder = 'N/A';\n  }\n\n  if (required && isEmpty(value)) {\n    value = placeholder;\n  }\n\n  if (typeof value === 'string') {\n    return value.substring(0, limit);\n  }\n\n  return value;\n}\n\nfunction isEmpty(value) {\n  return value == null || value === '' || typeof value === 'undefined';\n}\n\nfunction replaceValue(target, key, currModel) {\n  var value = truncate(target[key], currModel[0], currModel[1]);\n\n  if (isEmpty(value)) {\n    delete target[key];\n    return;\n  }\n\n  target[key] = value;\n}\n\nfunction truncateModel(model, target, childTarget) {\n  if (model === void 0) {\n    model = {};\n  }\n\n  if (childTarget === void 0) {\n    childTarget = target;\n  }\n\n  var keys = Object.keys(model);\n  var emptyArr = [];\n\n  var _loop = function _loop(i) {\n    var currKey = keys[i];\n    var currModel = model[currKey] === true ? emptyArr : model[currKey];\n\n    if (!Array.isArray(currModel)) {\n      truncateModel(currModel, target, childTarget[currKey]);\n    } else {\n      if (currKey === '*') {\n        Object.keys(childTarget).forEach(function (key) {\n          return replaceValue(childTarget, key, currModel);\n        });\n      } else {\n        replaceValue(childTarget, currKey, currModel);\n      }\n    }\n  };\n\n  for (var i = 0; i < keys.length; i++) {\n    _loop(i);\n  }\n\n  return target;\n}\n\nexport { truncate, truncateModel, SPAN_MODEL, TRANSACTION_MODEL, ERROR_MODEL, METADATA_MODEL, RESPONSE_MODEL };","var _excluded = [\"tags\"];\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport { createStackTraces, filterInvalidFrames } from './stack-trace';\nimport { generateRandomId, merge, extend } from '../common/utils';\nimport { getPageContext } from '../common/context';\nimport { truncateModel, ERROR_MODEL } from '../common/truncate';\nvar IGNORE_KEYS = ['stack', 'message'];\n\nfunction getErrorProperties(error) {\n  var propertyFound = false;\n  var properties = {};\n  Object.keys(error).forEach(function (key) {\n    if (IGNORE_KEYS.indexOf(key) >= 0) {\n      return;\n    }\n\n    var val = error[key];\n\n    if (val == null || typeof val === 'function') {\n      return;\n    }\n\n    if (typeof val === 'object') {\n      if (typeof val.toISOString !== 'function') return;\n      val = val.toISOString();\n    }\n\n    properties[key] = val;\n    propertyFound = true;\n  });\n\n  if (propertyFound) {\n    return properties;\n  }\n}\n\nvar ErrorLogging = function () {\n  function ErrorLogging(apmServer, configService, transactionService) {\n    this._apmServer = apmServer;\n    this._configService = configService;\n    this._transactionService = transactionService;\n  }\n\n  var _proto = ErrorLogging.prototype;\n\n  _proto.createErrorDataModel = function createErrorDataModel(errorEvent) {\n    var frames = createStackTraces(errorEvent);\n    var filteredFrames = filterInvalidFrames(frames);\n    var culprit = '(inline script)';\n    var lastFrame = filteredFrames[filteredFrames.length - 1];\n\n    if (lastFrame && lastFrame.filename) {\n      culprit = lastFrame.filename;\n    }\n\n    var message = errorEvent.message,\n        error = errorEvent.error;\n    var errorMessage = message;\n    var errorType = '';\n    var errorContext = {};\n\n    if (error && typeof error === 'object') {\n      errorMessage = errorMessage || error.message;\n      errorType = error.name;\n      var customProperties = getErrorProperties(error);\n\n      if (customProperties) {\n        errorContext.custom = customProperties;\n      }\n    }\n\n    if (!errorType) {\n      if (errorMessage && errorMessage.indexOf(':') > -1) {\n        errorType = errorMessage.split(':')[0];\n      }\n    }\n\n    var currentTransaction = this._transactionService.getCurrentTransaction();\n\n    var transactionContext = currentTransaction ? currentTransaction.context : {};\n\n    var _this$_configService$ = this._configService.get('context'),\n        tags = _this$_configService$.tags,\n        configContext = _objectWithoutPropertiesLoose(_this$_configService$, _excluded);\n\n    var pageContext = getPageContext();\n    var context = merge({}, pageContext, transactionContext, configContext, errorContext);\n    var errorObject = {\n      id: generateRandomId(),\n      culprit: culprit,\n      exception: {\n        message: errorMessage,\n        stacktrace: filteredFrames,\n        type: errorType\n      },\n      context: context\n    };\n\n    if (currentTransaction) {\n      errorObject = extend(errorObject, {\n        trace_id: currentTransaction.traceId,\n        parent_id: currentTransaction.id,\n        transaction_id: currentTransaction.id,\n        transaction: {\n          type: currentTransaction.type,\n          sampled: currentTransaction.sampled\n        }\n      });\n    }\n\n    return truncateModel(ERROR_MODEL, errorObject);\n  };\n\n  _proto.logErrorEvent = function logErrorEvent(errorEvent) {\n    if (typeof errorEvent === 'undefined') {\n      return;\n    }\n\n    var errorObject = this.createErrorDataModel(errorEvent);\n\n    if (typeof errorObject.exception.message === 'undefined') {\n      return;\n    }\n\n    this._apmServer.addError(errorObject);\n  };\n\n  _proto.registerListeners = function registerListeners() {\n    var _this = this;\n\n    window.addEventListener('error', function (errorEvent) {\n      return _this.logErrorEvent(errorEvent);\n    });\n    window.addEventListener('unhandledrejection', function (promiseRejectionEvent) {\n      return _this.logPromiseEvent(promiseRejectionEvent);\n    });\n  };\n\n  _proto.logPromiseEvent = function logPromiseEvent(promiseRejectionEvent) {\n    var prefix = 'Unhandled promise rejection: ';\n    var reason = promiseRejectionEvent.reason;\n\n    if (reason == null) {\n      reason = '<no reason specified>';\n    }\n\n    var errorEvent;\n\n    if (typeof reason.message === 'string') {\n      var name = reason.name ? reason.name + ': ' : '';\n      errorEvent = {\n        error: reason,\n        message: prefix + name + reason.message\n      };\n    } else {\n      reason = typeof reason === 'object' ? '<object>' : typeof reason === 'function' ? '<function>' : reason;\n      errorEvent = {\n        message: prefix + reason\n      };\n    }\n\n    this.logErrorEvent(errorEvent);\n  };\n\n  _proto.logError = function logError(messageOrError) {\n    var errorEvent = {};\n\n    if (typeof messageOrError === 'string') {\n      errorEvent.message = messageOrError;\n    } else {\n      errorEvent.error = messageOrError;\n    }\n\n    return this.logErrorEvent(errorEvent);\n  };\n\n  return ErrorLogging;\n}();\n\nexport default ErrorLogging;","var Queue = function () {\n  function Queue(onFlush, opts) {\n    if (opts === void 0) {\n      opts = {};\n    }\n\n    this.onFlush = onFlush;\n    this.items = [];\n    this.queueLimit = opts.queueLimit || -1;\n    this.flushInterval = opts.flushInterval || 0;\n    this.timeoutId = undefined;\n  }\n\n  var _proto = Queue.prototype;\n\n  _proto._setTimer = function _setTimer() {\n    var _this = this;\n\n    this.timeoutId = setTimeout(function () {\n      return _this.flush();\n    }, this.flushInterval);\n  };\n\n  _proto._clear = function _clear() {\n    if (typeof this.timeoutId !== 'undefined') {\n      clearTimeout(this.timeoutId);\n      this.timeoutId = undefined;\n    }\n\n    this.items = [];\n  };\n\n  _proto.flush = function flush() {\n    this.onFlush(this.items);\n\n    this._clear();\n  };\n\n  _proto.add = function add(item) {\n    this.items.push(item);\n\n    if (this.queueLimit !== -1 && this.items.length >= this.queueLimit) {\n      this.flush();\n    } else {\n      if (typeof this.timeoutId === 'undefined') {\n        this._setTimer();\n      }\n    }\n  };\n\n  return Queue;\n}();\n\nexport default Queue;","var NDJSON = function () {\n  function NDJSON() {}\n\n  NDJSON.stringify = function stringify(object) {\n    return JSON.stringify(object) + '\\n';\n  };\n\n  return NDJSON;\n}();\n\nexport default NDJSON;","export var globalState = {\n  fetchInProgress: false\n};\nexport function apmSymbol(name) {\n  return '__apm_symbol__' + name;\n}\n\nfunction isPropertyWritable(propertyDesc) {\n  if (!propertyDesc) {\n    return true;\n  }\n\n  if (propertyDesc.writable === false) {\n    return false;\n  }\n\n  return !(typeof propertyDesc.get === 'function' && typeof propertyDesc.set === 'undefined');\n}\n\nfunction attachOriginToPatched(patched, original) {\n  patched[apmSymbol('OriginalDelegate')] = original;\n}\n\nexport function patchMethod(target, name, patchFn) {\n  var proto = target;\n\n  while (proto && !proto.hasOwnProperty(name)) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  if (!proto && target[name]) {\n    proto = target;\n  }\n\n  var delegateName = apmSymbol(name);\n  var delegate;\n\n  if (proto && !(delegate = proto[delegateName])) {\n    delegate = proto[delegateName] = proto[name];\n    var desc = proto && Object.getOwnPropertyDescriptor(proto, name);\n\n    if (isPropertyWritable(desc)) {\n      var patchDelegate = patchFn(delegate, delegateName, name);\n\n      proto[name] = function () {\n        return patchDelegate(this, arguments);\n      };\n\n      attachOriginToPatched(proto[name], delegate);\n    }\n  }\n\n  return delegate;\n}\nexport var XHR_IGNORE = apmSymbol('xhrIgnore');\nexport var XHR_SYNC = apmSymbol('xhrSync');\nexport var XHR_URL = apmSymbol('xhrURL');\nexport var XHR_METHOD = apmSymbol('xhrMethod');","import { generateRandomId, setLabel, merge, getDuration, getTime } from '../common/utils';\nimport { NAME_UNKNOWN, TYPE_CUSTOM } from '../common/constants';\n\nvar SpanBase = function () {\n  function SpanBase(name, type, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!name) {\n      name = NAME_UNKNOWN;\n    }\n\n    if (!type) {\n      type = TYPE_CUSTOM;\n    }\n\n    this.name = name;\n    this.type = type;\n    this.options = options;\n    this.id = options.id || generateRandomId(16);\n    this.traceId = options.traceId;\n    this.sampled = options.sampled;\n    this.sampleRate = options.sampleRate;\n    this.timestamp = options.timestamp;\n    this._start = getTime(options.startTime);\n    this._end = undefined;\n    this.ended = false;\n    this.outcome = undefined;\n    this.onEnd = options.onEnd;\n  }\n\n  var _proto = SpanBase.prototype;\n\n  _proto.ensureContext = function ensureContext() {\n    if (!this.context) {\n      this.context = {};\n    }\n  };\n\n  _proto.addLabels = function addLabels(tags) {\n    this.ensureContext();\n    var ctx = this.context;\n\n    if (!ctx.tags) {\n      ctx.tags = {};\n    }\n\n    var keys = Object.keys(tags);\n    keys.forEach(function (k) {\n      return setLabel(k, tags[k], ctx.tags);\n    });\n  };\n\n  _proto.addContext = function addContext() {\n    for (var _len = arguments.length, context = new Array(_len), _key = 0; _key < _len; _key++) {\n      context[_key] = arguments[_key];\n    }\n\n    if (context.length === 0) return;\n    this.ensureContext();\n    merge.apply(void 0, [this.context].concat(context));\n  };\n\n  _proto.end = function end(endTime) {\n    if (this.ended) {\n      return;\n    }\n\n    this.ended = true;\n    this._end = getTime(endTime);\n    this.callOnEnd();\n  };\n\n  _proto.callOnEnd = function callOnEnd() {\n    if (typeof this.onEnd === 'function') {\n      this.onEnd(this);\n    }\n  };\n\n  _proto.duration = function duration() {\n    return getDuration(this._start, this._end);\n  };\n\n  return SpanBase;\n}();\n\nexport default SpanBase;","function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport SpanBase from './span-base';\nimport { addSpanContext } from '../common/context';\n\nvar Span = function (_SpanBase) {\n  _inheritsLoose(Span, _SpanBase);\n\n  function Span(name, type, options) {\n    var _this;\n\n    _this = _SpanBase.call(this, name, type, options) || this;\n    _this.parentId = _this.options.parentId;\n    _this.subtype = undefined;\n    _this.action = undefined;\n\n    if (_this.type.indexOf('.') !== -1) {\n      var fields = _this.type.split('.', 3);\n\n      _this.type = fields[0];\n      _this.subtype = fields[1];\n      _this.action = fields[2];\n    }\n\n    _this.sync = _this.options.sync;\n    return _this;\n  }\n\n  var _proto = Span.prototype;\n\n  _proto.end = function end(endTime, data) {\n    _SpanBase.prototype.end.call(this, endTime);\n\n    addSpanContext(this, data);\n  };\n\n  return Span;\n}(SpanBase);\n\nexport default Span;","var __DEV__ = process.env.NODE_ENV !== 'production';\n\nvar state = {\n  bootstrapTime: null,\n  lastHiddenStart: Number.MIN_SAFE_INTEGER\n};\nexport { __DEV__, state };","import Span from './span';\nimport { RESOURCE_INITIATOR_TYPES, MAX_SPAN_DURATION, USER_TIMING_THRESHOLD, PAGE_LOAD, RESOURCE, MEASURE } from '../common/constants';\nimport { stripQueryStringFromUrl, PERF, isPerfTimelineSupported } from '../common/utils';\nimport { state } from '../state';\nvar eventPairs = [['domainLookupStart', 'domainLookupEnd', 'Domain lookup'], ['connectStart', 'connectEnd', 'Making a connection to the server'], ['requestStart', 'responseEnd', 'Requesting and receiving the document'], ['domLoading', 'domInteractive', 'Parsing the document, executing sync. scripts'], ['domContentLoadedEventStart', 'domContentLoadedEventEnd', 'Fire \"DOMContentLoaded\" event'], ['loadEventStart', 'loadEventEnd', 'Fire \"load\" event']];\n\nfunction shouldCreateSpan(start, end, trStart, trEnd, baseTime) {\n  if (baseTime === void 0) {\n    baseTime = 0;\n  }\n\n  return typeof start === 'number' && typeof end === 'number' && start >= baseTime && end > start && start - baseTime >= trStart && end - baseTime <= trEnd && end - start < MAX_SPAN_DURATION && start - baseTime < MAX_SPAN_DURATION && end - baseTime < MAX_SPAN_DURATION;\n}\n\nfunction createNavigationTimingSpans(timings, baseTime, trStart, trEnd) {\n  var spans = [];\n\n  for (var i = 0; i < eventPairs.length; i++) {\n    var start = timings[eventPairs[i][0]];\n    var end = timings[eventPairs[i][1]];\n\n    if (!shouldCreateSpan(start, end, trStart, trEnd, baseTime)) {\n      continue;\n    }\n\n    var span = new Span(eventPairs[i][2], 'hard-navigation.browser-timing');\n    var data = null;\n\n    if (eventPairs[i][0] === 'requestStart') {\n      span.pageResponse = true;\n      data = {\n        url: location.origin\n      };\n    }\n\n    span._start = start - baseTime;\n    span.end(end - baseTime, data);\n    spans.push(span);\n  }\n\n  return spans;\n}\n\nfunction createResourceTimingSpan(resourceTimingEntry) {\n  var name = resourceTimingEntry.name,\n      initiatorType = resourceTimingEntry.initiatorType,\n      startTime = resourceTimingEntry.startTime,\n      responseEnd = resourceTimingEntry.responseEnd;\n  var kind = 'resource';\n\n  if (initiatorType) {\n    kind += '.' + initiatorType;\n  }\n\n  var spanName = stripQueryStringFromUrl(name);\n  var span = new Span(spanName, kind);\n  span._start = startTime;\n  span.end(responseEnd, {\n    url: name,\n    entry: resourceTimingEntry\n  });\n  return span;\n}\n\nfunction isCapturedByPatching(resourceStartTime, requestPatchTime) {\n  return requestPatchTime != null && resourceStartTime > requestPatchTime;\n}\n\nfunction isIntakeAPIEndpoint(url) {\n  return /intake\\/v\\d+\\/rum\\/events/.test(url);\n}\n\nfunction createResourceTimingSpans(entries, requestPatchTime, trStart, trEnd) {\n  var spans = [];\n\n  for (var i = 0; i < entries.length; i++) {\n    var _entries$i = entries[i],\n        initiatorType = _entries$i.initiatorType,\n        name = _entries$i.name,\n        startTime = _entries$i.startTime,\n        responseEnd = _entries$i.responseEnd;\n\n    if (RESOURCE_INITIATOR_TYPES.indexOf(initiatorType) === -1 || name == null) {\n      continue;\n    }\n\n    if ((initiatorType === 'xmlhttprequest' || initiatorType === 'fetch') && (isIntakeAPIEndpoint(name) || isCapturedByPatching(startTime, requestPatchTime))) {\n      continue;\n    }\n\n    if (shouldCreateSpan(startTime, responseEnd, trStart, trEnd)) {\n      spans.push(createResourceTimingSpan(entries[i]));\n    }\n  }\n\n  return spans;\n}\n\nfunction createUserTimingSpans(entries, trStart, trEnd) {\n  var userTimingSpans = [];\n\n  for (var i = 0; i < entries.length; i++) {\n    var _entries$i2 = entries[i],\n        name = _entries$i2.name,\n        startTime = _entries$i2.startTime,\n        duration = _entries$i2.duration;\n    var end = startTime + duration;\n\n    if (duration <= USER_TIMING_THRESHOLD || !shouldCreateSpan(startTime, end, trStart, trEnd)) {\n      continue;\n    }\n\n    var kind = 'app';\n    var span = new Span(name, kind);\n    span._start = startTime;\n    span.end(end);\n    userTimingSpans.push(span);\n  }\n\n  return userTimingSpans;\n}\n\nvar NAVIGATION_TIMING_MARKS = ['fetchStart', 'domainLookupStart', 'domainLookupEnd', 'connectStart', 'connectEnd', 'requestStart', 'responseStart', 'responseEnd', 'domLoading', 'domInteractive', 'domContentLoadedEventStart', 'domContentLoadedEventEnd', 'domComplete', 'loadEventStart', 'loadEventEnd'];\nvar COMPRESSED_NAV_TIMING_MARKS = ['fs', 'ls', 'le', 'cs', 'ce', 'qs', 'rs', 're', 'dl', 'di', 'ds', 'de', 'dc', 'es', 'ee'];\n\nfunction getNavigationTimingMarks(timing) {\n  var fetchStart = timing.fetchStart,\n      navigationStart = timing.navigationStart,\n      responseStart = timing.responseStart,\n      responseEnd = timing.responseEnd;\n\n  if (fetchStart >= navigationStart && responseStart >= fetchStart && responseEnd >= responseStart) {\n    var marks = {};\n    NAVIGATION_TIMING_MARKS.forEach(function (timingKey) {\n      var m = timing[timingKey];\n\n      if (m && m >= fetchStart) {\n        marks[timingKey] = parseInt(m - fetchStart);\n      }\n    });\n    return marks;\n  }\n\n  return null;\n}\n\nfunction getPageLoadMarks(timing) {\n  var marks = getNavigationTimingMarks(timing);\n\n  if (marks == null) {\n    return null;\n  }\n\n  return {\n    navigationTiming: marks,\n    agent: {\n      timeToFirstByte: marks.responseStart,\n      domInteractive: marks.domInteractive,\n      domComplete: marks.domComplete\n    }\n  };\n}\n\nfunction captureNavigation(transaction) {\n  if (!transaction.captureTimings) {\n    return;\n  }\n\n  var trEnd = transaction._end;\n\n  if (transaction.type === PAGE_LOAD) {\n    if (transaction.marks && transaction.marks.custom) {\n      var customMarks = transaction.marks.custom;\n      Object.keys(customMarks).forEach(function (key) {\n        customMarks[key] += transaction._start;\n      });\n    }\n\n    var trStart = 0;\n    transaction._start = trStart;\n    var timings = PERF.timing;\n    createNavigationTimingSpans(timings, timings.fetchStart, trStart, trEnd).forEach(function (span) {\n      span.traceId = transaction.traceId;\n      span.sampled = transaction.sampled;\n\n      if (span.pageResponse && transaction.options.pageLoadSpanId) {\n        span.id = transaction.options.pageLoadSpanId;\n      }\n\n      transaction.spans.push(span);\n    });\n    transaction.addMarks(getPageLoadMarks(timings));\n  }\n\n  if (isPerfTimelineSupported()) {\n    var _trStart = transaction._start;\n    var resourceEntries = PERF.getEntriesByType(RESOURCE);\n    createResourceTimingSpans(resourceEntries, state.bootstrapTime, _trStart, trEnd).forEach(function (span) {\n      return transaction.spans.push(span);\n    });\n    var userEntries = PERF.getEntriesByType(MEASURE);\n    createUserTimingSpans(userEntries, _trStart, trEnd).forEach(function (span) {\n      return transaction.spans.push(span);\n    });\n  }\n}\n\nexport { getPageLoadMarks, captureNavigation, createNavigationTimingSpans, createResourceTimingSpans, createUserTimingSpans, NAVIGATION_TIMING_MARKS, COMPRESSED_NAV_TIMING_MARKS };","import { Promise } from './polyfills';\nimport { NAVIGATION_TIMING_MARKS, COMPRESSED_NAV_TIMING_MARKS } from '../performance-monitoring/capture-navigation';\n\nfunction compressStackFrames(frames) {\n  return frames.map(function (frame) {\n    return {\n      ap: frame.abs_path,\n      f: frame.filename,\n      fn: frame.function,\n      li: frame.lineno,\n      co: frame.colno\n    };\n  });\n}\n\nfunction compressResponse(response) {\n  return {\n    ts: response.transfer_size,\n    ebs: response.encoded_body_size,\n    dbs: response.decoded_body_size\n  };\n}\n\nfunction compressHTTP(http) {\n  var compressed = {};\n  var method = http.method,\n      status_code = http.status_code,\n      url = http.url,\n      response = http.response;\n  compressed.url = url;\n\n  if (method) {\n    compressed.mt = method;\n  }\n\n  if (status_code) {\n    compressed.sc = status_code;\n  }\n\n  if (response) {\n    compressed.r = compressResponse(response);\n  }\n\n  return compressed;\n}\n\nfunction compressContext(context) {\n  if (!context) {\n    return null;\n  }\n\n  var compressed = {};\n  var page = context.page,\n      http = context.http,\n      response = context.response,\n      destination = context.destination,\n      user = context.user,\n      custom = context.custom;\n\n  if (page) {\n    compressed.p = {\n      rf: page.referer,\n      url: page.url\n    };\n  }\n\n  if (http) {\n    compressed.h = compressHTTP(http);\n  }\n\n  if (response) {\n    compressed.r = compressResponse(response);\n  }\n\n  if (destination) {\n    var service = destination.service;\n    compressed.dt = {\n      se: {\n        n: service.name,\n        t: service.type,\n        rc: service.resource\n      },\n      ad: destination.address,\n      po: destination.port\n    };\n  }\n\n  if (user) {\n    compressed.u = {\n      id: user.id,\n      un: user.username,\n      em: user.email\n    };\n  }\n\n  if (custom) {\n    compressed.cu = custom;\n  }\n\n  return compressed;\n}\n\nfunction compressMarks(marks) {\n  if (!marks) {\n    return null;\n  }\n\n  var compressedNtMarks = compressNavigationTimingMarks(marks.navigationTiming);\n  var compressed = {\n    nt: compressedNtMarks,\n    a: compressAgentMarks(compressedNtMarks, marks.agent)\n  };\n  return compressed;\n}\n\nfunction compressNavigationTimingMarks(ntMarks) {\n  if (!ntMarks) {\n    return null;\n  }\n\n  var compressed = {};\n  COMPRESSED_NAV_TIMING_MARKS.forEach(function (mark, index) {\n    var mapping = NAVIGATION_TIMING_MARKS[index];\n    compressed[mark] = ntMarks[mapping];\n  });\n  return compressed;\n}\n\nfunction compressAgentMarks(compressedNtMarks, agentMarks) {\n  var compressed = {};\n\n  if (compressedNtMarks) {\n    compressed = {\n      fb: compressedNtMarks.rs,\n      di: compressedNtMarks.di,\n      dc: compressedNtMarks.dc\n    };\n  }\n\n  if (agentMarks) {\n    var fp = agentMarks.firstContentfulPaint;\n    var lp = agentMarks.largestContentfulPaint;\n\n    if (fp) {\n      compressed.fp = fp;\n    }\n\n    if (lp) {\n      compressed.lp = lp;\n    }\n  }\n\n  if (Object.keys(compressed).length === 0) {\n    return null;\n  }\n\n  return compressed;\n}\n\nexport function compressMetadata(metadata) {\n  var service = metadata.service,\n      labels = metadata.labels;\n  var agent = service.agent,\n      language = service.language;\n  return {\n    se: {\n      n: service.name,\n      ve: service.version,\n      a: {\n        n: agent.name,\n        ve: agent.version\n      },\n      la: {\n        n: language.name\n      },\n      en: service.environment\n    },\n    l: labels\n  };\n}\nexport function compressTransaction(transaction) {\n  var spans = transaction.spans.map(function (span) {\n    var spanData = {\n      id: span.id,\n      n: span.name,\n      t: span.type,\n      s: span.start,\n      d: span.duration,\n      c: compressContext(span.context),\n      o: span.outcome,\n      sr: span.sample_rate\n    };\n\n    if (span.parent_id !== transaction.id) {\n      spanData.pid = span.parent_id;\n    }\n\n    if (span.sync === true) {\n      spanData.sy = true;\n    }\n\n    if (span.subtype) {\n      spanData.su = span.subtype;\n    }\n\n    if (span.action) {\n      spanData.ac = span.action;\n    }\n\n    return spanData;\n  });\n  var tr = {\n    id: transaction.id,\n    tid: transaction.trace_id,\n    n: transaction.name,\n    t: transaction.type,\n    d: transaction.duration,\n    c: compressContext(transaction.context),\n    k: compressMarks(transaction.marks),\n    me: compressMetricsets(transaction.breakdown),\n    y: spans,\n    yc: {\n      sd: spans.length\n    },\n    sm: transaction.sampled,\n    sr: transaction.sample_rate,\n    o: transaction.outcome\n  };\n\n  if (transaction.experience) {\n    var _transaction$experien = transaction.experience,\n        cls = _transaction$experien.cls,\n        fid = _transaction$experien.fid,\n        tbt = _transaction$experien.tbt,\n        longtask = _transaction$experien.longtask;\n    tr.exp = {\n      cls: cls,\n      fid: fid,\n      tbt: tbt,\n      lt: longtask\n    };\n  }\n\n  if (transaction.session) {\n    var _transaction$session = transaction.session,\n        id = _transaction$session.id,\n        sequence = _transaction$session.sequence;\n    tr.ses = {\n      id: id,\n      seq: sequence\n    };\n  }\n\n  return tr;\n}\nexport function compressError(error) {\n  var exception = error.exception;\n  var compressed = {\n    id: error.id,\n    cl: error.culprit,\n    ex: {\n      mg: exception.message,\n      st: compressStackFrames(exception.stacktrace),\n      t: error.type\n    },\n    c: compressContext(error.context)\n  };\n  var transaction = error.transaction;\n\n  if (transaction) {\n    compressed.tid = error.trace_id;\n    compressed.pid = error.parent_id;\n    compressed.xid = error.transaction_id;\n    compressed.x = {\n      t: transaction.type,\n      sm: transaction.sampled\n    };\n  }\n\n  return compressed;\n}\nexport function compressMetricsets(breakdowns) {\n  return breakdowns.map(function (_ref) {\n    var span = _ref.span,\n        samples = _ref.samples;\n    var isSpan = span != null;\n\n    if (isSpan) {\n      return {\n        y: {\n          t: span.type\n        },\n        sa: {\n          ysc: {\n            v: samples['span.self_time.count'].value\n          },\n          yss: {\n            v: samples['span.self_time.sum.us'].value\n          }\n        }\n      };\n    }\n\n    return {\n      sa: {\n        xdc: {\n          v: samples['transaction.duration.count'].value\n        },\n        xds: {\n          v: samples['transaction.duration.sum.us'].value\n        },\n        xbc: {\n          v: samples['transaction.breakdown.count'].value\n        }\n      }\n    };\n  });\n}\nexport function compressPayload(params, type) {\n  if (type === void 0) {\n    type = 'gzip';\n  }\n\n  var isCompressionStreamSupported = typeof CompressionStream === 'function';\n  return new Promise(function (resolve) {\n    if (!isCompressionStreamSupported) {\n      return resolve(params);\n    }\n\n    var payload = params.payload,\n        headers = params.headers,\n        beforeSend = params.beforeSend;\n    var payloadStream = new Blob([payload]).stream();\n    var compressedStream = payloadStream.pipeThrough(new CompressionStream(type));\n    return new Response(compressedStream).blob().then(function (payload) {\n      headers['Content-Encoding'] = type;\n      return resolve({\n        payload: payload,\n        headers: headers,\n        beforeSend: beforeSend\n      });\n    });\n  });\n}","import Queue from './queue';\nimport throttle from './throttle';\nimport NDJSON from './ndjson';\nimport { XHR_IGNORE } from './patching/patch-utils';\nimport { truncateModel, METADATA_MODEL } from './truncate';\nimport { ERRORS, TRANSACTIONS } from './constants';\nimport { noop } from './utils';\nimport { Promise } from './polyfills';\nimport { compressMetadata, compressTransaction, compressError, compressPayload } from './compress';\nimport { __DEV__ } from '../state';\nvar THROTTLE_INTERVAL = 60000;\n\nvar ApmServer = function () {\n  function ApmServer(configService, loggingService) {\n    this._configService = configService;\n    this._loggingService = loggingService;\n    this.queue = undefined;\n    this.throttleEvents = noop;\n  }\n\n  var _proto = ApmServer.prototype;\n\n  _proto.init = function init() {\n    var _this = this;\n\n    var queueLimit = this._configService.get('queueLimit');\n\n    var flushInterval = this._configService.get('flushInterval');\n\n    var limit = this._configService.get('eventsLimit');\n\n    var onFlush = function onFlush(events) {\n      var promise = _this.sendEvents(events);\n\n      if (promise) {\n        promise.catch(function (reason) {\n          _this._loggingService.warn('Failed sending events!', _this._constructError(reason));\n        });\n      }\n    };\n\n    this.queue = new Queue(onFlush, {\n      queueLimit: queueLimit,\n      flushInterval: flushInterval\n    });\n    this.throttleEvents = throttle(this.queue.add.bind(this.queue), function () {\n      return _this._loggingService.warn('Dropped events due to throttling!');\n    }, {\n      limit: limit,\n      interval: THROTTLE_INTERVAL\n    });\n  };\n\n  _proto._postJson = function _postJson(endPoint, payload) {\n    var _this2 = this;\n\n    var headers = {\n      'Content-Type': 'application/x-ndjson'\n    };\n\n    var apmRequest = this._configService.get('apmRequest');\n\n    var params = {\n      payload: payload,\n      headers: headers,\n      beforeSend: apmRequest\n    };\n    return compressPayload(params).catch(function (error) {\n      if (__DEV__) {\n        _this2._loggingService.debug('Compressing the payload using CompressionStream API failed', error.message);\n      }\n\n      return params;\n    }).then(function (result) {\n      return _this2._makeHttpRequest('POST', endPoint, result);\n    }).then(function (_ref) {\n      var responseText = _ref.responseText;\n      return responseText;\n    });\n  };\n\n  _proto._constructError = function _constructError(reason) {\n    var url = reason.url,\n        status = reason.status,\n        responseText = reason.responseText;\n\n    if (typeof status == 'undefined') {\n      return reason;\n    }\n\n    var message = url + ' HTTP status: ' + status;\n\n    if (__DEV__ && responseText) {\n      try {\n        var serverErrors = [];\n        var response = JSON.parse(responseText);\n\n        if (response.errors && response.errors.length > 0) {\n          response.errors.forEach(function (err) {\n            return serverErrors.push(err.message);\n          });\n          message += ' ' + serverErrors.join(',');\n        }\n      } catch (e) {\n        this._loggingService.debug('Error parsing response from APM server', e);\n      }\n    }\n\n    return new Error(message);\n  };\n\n  _proto._makeHttpRequest = function _makeHttpRequest(method, url, _temp) {\n    var _ref2 = _temp === void 0 ? {} : _temp,\n        _ref2$timeout = _ref2.timeout,\n        timeout = _ref2$timeout === void 0 ? 10000 : _ref2$timeout,\n        payload = _ref2.payload,\n        headers = _ref2.headers,\n        beforeSend = _ref2.beforeSend;\n\n    return new Promise(function (resolve, reject) {\n      var xhr = new window.XMLHttpRequest();\n      xhr[XHR_IGNORE] = true;\n      xhr.open(method, url, true);\n      xhr.timeout = timeout;\n\n      if (headers) {\n        for (var header in headers) {\n          if (headers.hasOwnProperty(header)) {\n            xhr.setRequestHeader(header, headers[header]);\n          }\n        }\n      }\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === 4) {\n          var status = xhr.status,\n              responseText = xhr.responseText;\n\n          if (status === 0 || status > 399 && status < 600) {\n            reject({\n              url: url,\n              status: status,\n              responseText: responseText\n            });\n          } else {\n            resolve(xhr);\n          }\n        }\n      };\n\n      xhr.onerror = function () {\n        var status = xhr.status,\n            responseText = xhr.responseText;\n        reject({\n          url: url,\n          status: status,\n          responseText: responseText\n        });\n      };\n\n      var canSend = true;\n\n      if (typeof beforeSend === 'function') {\n        canSend = beforeSend({\n          url: url,\n          method: method,\n          headers: headers,\n          payload: payload,\n          xhr: xhr\n        });\n      }\n\n      if (canSend) {\n        xhr.send(payload);\n      } else {\n        reject({\n          url: url,\n          status: 0,\n          responseText: 'Request rejected by user configuration.'\n        });\n      }\n    });\n  };\n\n  _proto.fetchConfig = function fetchConfig(serviceName, environment) {\n    var _this3 = this;\n\n    var serverUrl = this._configService.get('serverUrl');\n\n    var configEndpoint = serverUrl + \"/config/v1/rum/agents\";\n\n    if (!serviceName) {\n      return Promise.reject('serviceName is required for fetching central config.');\n    }\n\n    configEndpoint += \"?service.name=\" + serviceName;\n\n    if (environment) {\n      configEndpoint += \"&service.environment=\" + environment;\n    }\n\n    var localConfig = this._configService.getLocalConfig();\n\n    if (localConfig) {\n      configEndpoint += \"&ifnonematch=\" + localConfig.etag;\n    }\n\n    var apmRequest = this._configService.get('apmRequest');\n\n    return this._makeHttpRequest('GET', configEndpoint, {\n      timeout: 5000,\n      beforeSend: apmRequest\n    }).then(function (xhr) {\n      var status = xhr.status,\n          responseText = xhr.responseText;\n\n      if (status === 304) {\n        return localConfig;\n      } else {\n        var remoteConfig = JSON.parse(responseText);\n        var etag = xhr.getResponseHeader('etag');\n\n        if (etag) {\n          remoteConfig.etag = etag.replace(/[\"]/g, '');\n\n          _this3._configService.setLocalConfig(remoteConfig, true);\n        }\n\n        return remoteConfig;\n      }\n    }).catch(function (reason) {\n      var error = _this3._constructError(reason);\n\n      return Promise.reject(error);\n    });\n  };\n\n  _proto.createMetaData = function createMetaData() {\n    var cfg = this._configService;\n    var metadata = {\n      service: {\n        name: cfg.get('serviceName'),\n        version: cfg.get('serviceVersion'),\n        agent: {\n          name: 'rum-js',\n          version: cfg.version\n        },\n        language: {\n          name: 'javascript'\n        },\n        environment: cfg.get('environment')\n      },\n      labels: cfg.get('context.tags')\n    };\n    return truncateModel(METADATA_MODEL, metadata);\n  };\n\n  _proto.addError = function addError(error) {\n    var _this$throttleEvents;\n\n    this.throttleEvents((_this$throttleEvents = {}, _this$throttleEvents[ERRORS] = error, _this$throttleEvents));\n  };\n\n  _proto.addTransaction = function addTransaction(transaction) {\n    var _this$throttleEvents2;\n\n    this.throttleEvents((_this$throttleEvents2 = {}, _this$throttleEvents2[TRANSACTIONS] = transaction, _this$throttleEvents2));\n  };\n\n  _proto.ndjsonErrors = function ndjsonErrors(errors, compress) {\n    var key = compress ? 'e' : 'error';\n    return errors.map(function (error) {\n      var _NDJSON$stringify;\n\n      return NDJSON.stringify((_NDJSON$stringify = {}, _NDJSON$stringify[key] = compress ? compressError(error) : error, _NDJSON$stringify));\n    });\n  };\n\n  _proto.ndjsonMetricsets = function ndjsonMetricsets(metricsets) {\n    return metricsets.map(function (metricset) {\n      return NDJSON.stringify({\n        metricset: metricset\n      });\n    }).join('');\n  };\n\n  _proto.ndjsonTransactions = function ndjsonTransactions(transactions, compress) {\n    var _this4 = this;\n\n    var key = compress ? 'x' : 'transaction';\n    return transactions.map(function (tr) {\n      var _NDJSON$stringify2;\n\n      var spans = '',\n          breakdowns = '';\n\n      if (!compress) {\n        if (tr.spans) {\n          spans = tr.spans.map(function (span) {\n            return NDJSON.stringify({\n              span: span\n            });\n          }).join('');\n          delete tr.spans;\n        }\n\n        if (tr.breakdown) {\n          breakdowns = _this4.ndjsonMetricsets(tr.breakdown);\n          delete tr.breakdown;\n        }\n      }\n\n      return NDJSON.stringify((_NDJSON$stringify2 = {}, _NDJSON$stringify2[key] = compress ? compressTransaction(tr) : tr, _NDJSON$stringify2)) + spans + breakdowns;\n    });\n  };\n\n  _proto.sendEvents = function sendEvents(events) {\n    var _payload, _NDJSON$stringify3;\n\n    if (events.length === 0) {\n      return;\n    }\n\n    var transactions = [];\n    var errors = [];\n\n    for (var i = 0; i < events.length; i++) {\n      var event = events[i];\n\n      if (event[TRANSACTIONS]) {\n        transactions.push(event[TRANSACTIONS]);\n      }\n\n      if (event[ERRORS]) {\n        errors.push(event[ERRORS]);\n      }\n    }\n\n    if (transactions.length === 0 && errors.length === 0) {\n      return;\n    }\n\n    var cfg = this._configService;\n    var payload = (_payload = {}, _payload[TRANSACTIONS] = transactions, _payload[ERRORS] = errors, _payload);\n    var filteredPayload = cfg.applyFilters(payload);\n\n    if (!filteredPayload) {\n      this._loggingService.warn('Dropped payload due to filtering!');\n\n      return;\n    }\n\n    var apiVersion = cfg.get('apiVersion');\n    var compress = apiVersion > 2;\n    var ndjson = [];\n    var metadata = this.createMetaData();\n    var metadataKey = compress ? 'm' : 'metadata';\n    ndjson.push(NDJSON.stringify((_NDJSON$stringify3 = {}, _NDJSON$stringify3[metadataKey] = compress ? compressMetadata(metadata) : metadata, _NDJSON$stringify3)));\n    ndjson = ndjson.concat(this.ndjsonErrors(filteredPayload[ERRORS], compress), this.ndjsonTransactions(filteredPayload[TRANSACTIONS], compress));\n    var ndjsonPayload = ndjson.join('');\n    var serverUrlPrefix = cfg.get('serverUrlPrefix') || \"/intake/v\" + apiVersion + \"/rum/events\";\n    var endPoint = cfg.get('serverUrl') + serverUrlPrefix;\n    return this._postJson(endPoint, ndjsonPayload);\n  };\n\n  return ApmServer;\n}();\n\nexport default ApmServer;","export default function throttle(fn, onThrottle, opts) {\n  var context = this;\n  var limit = opts.limit;\n  var interval = opts.interval;\n  var counter = 0;\n  var timeoutId;\n  return function () {\n    counter++;\n\n    if (typeof timeoutId === 'undefined') {\n      timeoutId = setTimeout(function () {\n        counter = 0;\n        timeoutId = undefined;\n      }, interval);\n    }\n\n    if (counter > limit && typeof onThrottle === 'function') {\n      return onThrottle.apply(context, arguments);\n    } else {\n      return fn.apply(context, arguments);\n    }\n  };\n}","import { BEFORE_EVENT, AFTER_EVENT } from './constants';\n\nvar EventHandler = function () {\n  function EventHandler() {\n    this.observers = {};\n  }\n\n  var _proto = EventHandler.prototype;\n\n  _proto.observe = function observe(name, fn) {\n    var _this = this;\n\n    if (typeof fn === 'function') {\n      if (!this.observers[name]) {\n        this.observers[name] = [];\n      }\n\n      this.observers[name].push(fn);\n      return function () {\n        var index = _this.observers[name].indexOf(fn);\n\n        if (index > -1) {\n          _this.observers[name].splice(index, 1);\n        }\n      };\n    }\n  };\n\n  _proto.sendOnly = function sendOnly(name, args) {\n    var obs = this.observers[name];\n\n    if (obs) {\n      obs.forEach(function (fn) {\n        try {\n          fn.apply(undefined, args);\n        } catch (error) {\n          console.log(error, error.stack);\n        }\n      });\n    }\n  };\n\n  _proto.send = function send(name, args) {\n    this.sendOnly(name + BEFORE_EVENT, args);\n    this.sendOnly(name, args);\n    this.sendOnly(name + AFTER_EVENT, args);\n  };\n\n  return EventHandler;\n}();\n\nexport default EventHandler;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { getCurrentScript, setLabel, merge, extend, isUndefined } from './utils';\nimport EventHandler from './event-handler';\nimport { CONFIG_CHANGE, LOCAL_CONFIG_KEY } from './constants';\n\nfunction getConfigFromScript() {\n  var script = getCurrentScript();\n  var config = getDataAttributesFromNode(script);\n  return config;\n}\n\nfunction getDataAttributesFromNode(node) {\n  if (!node) {\n    return {};\n  }\n\n  var dataAttrs = {};\n  var dataRegex = /^data-([\\w-]+)$/;\n  var attrs = node.attributes;\n\n  for (var i = 0; i < attrs.length; i++) {\n    var attr = attrs[i];\n\n    if (dataRegex.test(attr.nodeName)) {\n      var key = attr.nodeName.match(dataRegex)[1];\n      var camelCasedkey = key.split('-').map(function (value, index) {\n        return index > 0 ? value.charAt(0).toUpperCase() + value.substring(1) : value;\n      }).join('');\n      dataAttrs[camelCasedkey] = attr.value || attr.nodeValue;\n    }\n  }\n\n  return dataAttrs;\n}\n\nvar Config = function () {\n  function Config() {\n    this.config = {\n      serviceName: '',\n      serviceVersion: '',\n      environment: '',\n      serverUrl: 'http://localhost:8200',\n      serverUrlPrefix: '',\n      active: true,\n      instrument: true,\n      disableInstrumentations: [],\n      logLevel: 'warn',\n      breakdownMetrics: false,\n      ignoreTransactions: [],\n      eventsLimit: 80,\n      queueLimit: -1,\n      flushInterval: 500,\n      distributedTracing: true,\n      distributedTracingOrigins: [],\n      distributedTracingHeaderName: 'traceparent',\n      pageLoadTraceId: '',\n      pageLoadSpanId: '',\n      pageLoadSampled: false,\n      pageLoadTransactionName: '',\n      propagateTracestate: false,\n      transactionSampleRate: 1.0,\n      centralConfig: false,\n      monitorLongtasks: true,\n      apiVersion: 2,\n      context: {},\n      session: false,\n      apmRequest: null\n    };\n    this.events = new EventHandler();\n    this.filters = [];\n    this.version = '';\n  }\n\n  var _proto = Config.prototype;\n\n  _proto.init = function init() {\n    var scriptData = getConfigFromScript();\n    this.setConfig(scriptData);\n  };\n\n  _proto.setVersion = function setVersion(version) {\n    this.version = version;\n  };\n\n  _proto.addFilter = function addFilter(cb) {\n    if (typeof cb !== 'function') {\n      throw new Error('Argument to must be function');\n    }\n\n    this.filters.push(cb);\n  };\n\n  _proto.applyFilters = function applyFilters(data) {\n    for (var i = 0; i < this.filters.length; i++) {\n      data = this.filters[i](data);\n\n      if (!data) {\n        return;\n      }\n    }\n\n    return data;\n  };\n\n  _proto.get = function get(key) {\n    return key.split('.').reduce(function (obj, objKey) {\n      return obj && obj[objKey];\n    }, this.config);\n  };\n\n  _proto.setUserContext = function setUserContext(userContext) {\n    if (userContext === void 0) {\n      userContext = {};\n    }\n\n    var context = {};\n    var _userContext = userContext,\n        id = _userContext.id,\n        username = _userContext.username,\n        email = _userContext.email;\n\n    if (typeof id === 'number' || typeof id === 'string') {\n      context.id = id;\n    }\n\n    if (typeof username === 'string') {\n      context.username = username;\n    }\n\n    if (typeof email === 'string') {\n      context.email = email;\n    }\n\n    this.config.context.user = extend(this.config.context.user || {}, context);\n  };\n\n  _proto.setCustomContext = function setCustomContext(customContext) {\n    if (customContext === void 0) {\n      customContext = {};\n    }\n\n    this.config.context.custom = extend(this.config.context.custom || {}, customContext);\n  };\n\n  _proto.addLabels = function addLabels(tags) {\n    var _this = this;\n\n    if (!this.config.context.tags) {\n      this.config.context.tags = {};\n    }\n\n    var keys = Object.keys(tags);\n    keys.forEach(function (k) {\n      return setLabel(k, tags[k], _this.config.context.tags);\n    });\n  };\n\n  _proto.setConfig = function setConfig(properties) {\n    if (properties === void 0) {\n      properties = {};\n    }\n\n    var _properties = properties,\n        transactionSampleRate = _properties.transactionSampleRate,\n        serverUrl = _properties.serverUrl;\n\n    if (serverUrl) {\n      properties.serverUrl = serverUrl.replace(/\\/+$/, '');\n    }\n\n    if (!isUndefined(transactionSampleRate)) {\n      if (transactionSampleRate < 0.0001 && transactionSampleRate > 0) {\n        transactionSampleRate = 0.0001;\n      }\n\n      properties.transactionSampleRate = Math.round(transactionSampleRate * 10000) / 10000;\n    }\n\n    merge(this.config, properties);\n    this.events.send(CONFIG_CHANGE, [this.config]);\n  };\n\n  _proto.validate = function validate(properties) {\n    if (properties === void 0) {\n      properties = {};\n    }\n\n    var requiredKeys = ['serviceName', 'serverUrl'];\n    var errors = {\n      missing: [],\n      invalid: []\n    };\n    Object.keys(properties).forEach(function (key) {\n      if (requiredKeys.indexOf(key) !== -1 && !properties[key]) {\n        errors.missing.push(key);\n      }\n    });\n\n    if (properties.serviceName && !/^[a-zA-Z0-9 _-]+$/.test(properties.serviceName)) {\n      errors.invalid.push({\n        key: 'serviceName',\n        value: properties.serviceName,\n        allowed: 'a-z, A-Z, 0-9, _, -, <space>'\n      });\n    }\n\n    var sampleRate = properties.transactionSampleRate;\n\n    if (typeof sampleRate !== 'undefined' && (typeof sampleRate !== 'number' || isNaN(sampleRate) || sampleRate < 0 || sampleRate > 1)) {\n      errors.invalid.push({\n        key: 'transactionSampleRate',\n        value: sampleRate,\n        allowed: 'Number between 0 and 1'\n      });\n    }\n\n    return errors;\n  };\n\n  _proto.getLocalConfig = function getLocalConfig() {\n    var storage = sessionStorage;\n\n    if (this.config.session) {\n      storage = localStorage;\n    }\n\n    var config = storage.getItem(LOCAL_CONFIG_KEY);\n\n    if (config) {\n      return JSON.parse(config);\n    }\n  };\n\n  _proto.setLocalConfig = function setLocalConfig(config, merge) {\n    if (config) {\n      if (merge) {\n        var prevConfig = this.getLocalConfig();\n        config = _extends({}, prevConfig, config);\n      }\n\n      var storage = sessionStorage;\n\n      if (this.config.session) {\n        storage = localStorage;\n      }\n\n      storage.setItem(LOCAL_CONFIG_KEY, JSON.stringify(config));\n    }\n  };\n\n  return Config;\n}();\n\nexport default Config;","var _serviceCreators;\n\nimport ApmServer from './apm-server';\nimport ConfigService from './config-service';\nimport LoggingService from './logging-service';\nimport { CONFIG_CHANGE, CONFIG_SERVICE, LOGGING_SERVICE, APM_SERVER } from './constants';\nimport { __DEV__ } from '../state';\nvar serviceCreators = (_serviceCreators = {}, _serviceCreators[CONFIG_SERVICE] = function () {\n  return new ConfigService();\n}, _serviceCreators[LOGGING_SERVICE] = function () {\n  return new LoggingService({\n    prefix: '[Elastic APM] '\n  });\n}, _serviceCreators[APM_SERVER] = function (factory) {\n  var _factory$getService = factory.getService([CONFIG_SERVICE, LOGGING_SERVICE]),\n      configService = _factory$getService[0],\n      loggingService = _factory$getService[1];\n\n  return new ApmServer(configService, loggingService);\n}, _serviceCreators);\n\nvar ServiceFactory = function () {\n  function ServiceFactory() {\n    this.instances = {};\n    this.initialized = false;\n  }\n\n  var _proto = ServiceFactory.prototype;\n\n  _proto.init = function init() {\n    if (this.initialized) {\n      return;\n    }\n\n    this.initialized = true;\n    var configService = this.getService(CONFIG_SERVICE);\n    configService.init();\n\n    var _this$getService = this.getService([LOGGING_SERVICE, APM_SERVER]),\n        loggingService = _this$getService[0],\n        apmServer = _this$getService[1];\n\n    configService.events.observe(CONFIG_CHANGE, function () {\n      var logLevel = configService.get('logLevel');\n      loggingService.setLevel(logLevel);\n    });\n    apmServer.init();\n  };\n\n  _proto.getService = function getService(name) {\n    var _this = this;\n\n    if (typeof name === 'string') {\n      if (!this.instances[name]) {\n        if (typeof serviceCreators[name] === 'function') {\n          this.instances[name] = serviceCreators[name](this);\n        } else if (__DEV__) {\n          console.log('Cannot get service, No creator for: ' + name);\n        }\n      }\n\n      return this.instances[name];\n    } else if (Array.isArray(name)) {\n      return name.map(function (n) {\n        return _this.getService(n);\n      });\n    }\n  };\n\n  return ServiceFactory;\n}();\n\nexport { serviceCreators, ServiceFactory };","import { noop } from './utils';\n\nvar LoggingService = function () {\n  function LoggingService(spec) {\n    if (spec === void 0) {\n      spec = {};\n    }\n\n    this.levels = ['trace', 'debug', 'info', 'warn', 'error'];\n    this.level = spec.level || 'warn';\n    this.prefix = spec.prefix || '';\n    this.resetLogMethods();\n  }\n\n  var _proto = LoggingService.prototype;\n\n  _proto.shouldLog = function shouldLog(level) {\n    return this.levels.indexOf(level) >= this.levels.indexOf(this.level);\n  };\n\n  _proto.setLevel = function setLevel(level) {\n    if (level === this.level) {\n      return;\n    }\n\n    this.level = level;\n    this.resetLogMethods();\n  };\n\n  _proto.resetLogMethods = function resetLogMethods() {\n    var _this = this;\n\n    this.levels.forEach(function (level) {\n      _this[level] = _this.shouldLog(level) ? log : noop;\n\n      function log() {\n        var normalizedLevel = level;\n\n        if (level === 'trace' || level === 'debug') {\n          normalizedLevel = 'info';\n        }\n\n        var args = arguments;\n        args[0] = this.prefix + args[0];\n\n        if (console) {\n          var realMethod = console[normalizedLevel] || console.log;\n\n          if (typeof realMethod === 'function') {\n            realMethod.apply(console, args);\n          }\n        }\n      }\n    });\n  };\n\n  return LoggingService;\n}();\n\nexport default LoggingService;","import { patchMethod, XHR_SYNC, XHR_URL, XHR_METHOD, XHR_IGNORE } from './patch-utils';\nimport { SCHEDULE, INVOKE, XMLHTTPREQUEST, ADD_EVENT_LISTENER_STR } from '../constants';\nexport function patchXMLHttpRequest(callback) {\n  var XMLHttpRequestPrototype = XMLHttpRequest.prototype;\n\n  if (!XMLHttpRequestPrototype || !XMLHttpRequestPrototype[ADD_EVENT_LISTENER_STR]) {\n    return;\n  }\n\n  var READY_STATE_CHANGE = 'readystatechange';\n  var LOAD = 'load';\n  var ERROR = 'error';\n  var TIMEOUT = 'timeout';\n  var ABORT = 'abort';\n\n  function invokeTask(task, status) {\n    if (task.state !== INVOKE) {\n      task.state = INVOKE;\n      task.data.status = status;\n      callback(INVOKE, task);\n    }\n  }\n\n  function scheduleTask(task) {\n    if (task.state === SCHEDULE) {\n      return;\n    }\n\n    task.state = SCHEDULE;\n    callback(SCHEDULE, task);\n    var target = task.data.target;\n\n    function addListener(name) {\n      target[ADD_EVENT_LISTENER_STR](name, function (_ref) {\n        var type = _ref.type;\n\n        if (type === READY_STATE_CHANGE) {\n          if (target.readyState === 4 && target.status !== 0) {\n            invokeTask(task, 'success');\n          }\n        } else {\n          var status = type === LOAD ? 'success' : type;\n          invokeTask(task, status);\n        }\n      });\n    }\n\n    addListener(READY_STATE_CHANGE);\n    addListener(LOAD);\n    addListener(TIMEOUT);\n    addListener(ERROR);\n    addListener(ABORT);\n  }\n\n  var openNative = patchMethod(XMLHttpRequestPrototype, 'open', function () {\n    return function (self, args) {\n      if (!self[XHR_IGNORE]) {\n        self[XHR_METHOD] = args[0];\n        self[XHR_URL] = args[1];\n        self[XHR_SYNC] = args[2] === false;\n      }\n\n      return openNative.apply(self, args);\n    };\n  });\n  var sendNative = patchMethod(XMLHttpRequestPrototype, 'send', function () {\n    return function (self, args) {\n      if (self[XHR_IGNORE]) {\n        return sendNative.apply(self, args);\n      }\n\n      var task = {\n        source: XMLHTTPREQUEST,\n        state: '',\n        type: 'macroTask',\n        data: {\n          target: self,\n          method: self[XHR_METHOD],\n          sync: self[XHR_SYNC],\n          url: self[XHR_URL],\n          status: ''\n        }\n      };\n\n      try {\n        scheduleTask(task);\n        return sendNative.apply(self, args);\n      } catch (e) {\n        invokeTask(task, ERROR);\n        throw e;\n      }\n    };\n  });\n}","import { SCHEDULE, INVOKE, ADD_EVENT_LISTENER_STR, REMOVE_EVENT_LISTENER_STR, EVENT_TARGET } from '../constants';\nimport { apmSymbol } from './patch-utils';\nvar eventTypes = ['click'];\nvar eventTypeSymbols = {};\n\nfor (var i = 0; i < eventTypes.length; i++) {\n  var et = eventTypes[i];\n  eventTypeSymbols[et] = apmSymbol(et);\n}\n\nfunction shouldInstrumentEvent(target, eventType, listenerFn) {\n  return target instanceof EventTarget && eventTypes.indexOf(eventType) >= 0 && typeof listenerFn === 'function';\n}\n\nexport function patchEventTarget(callback) {\n  if (!window.EventTarget) {\n    return;\n  }\n\n  var proto = window.EventTarget.prototype;\n  var nativeAddEventListener = proto[ADD_EVENT_LISTENER_STR];\n  var nativeRemoveEventListener = proto[REMOVE_EVENT_LISTENER_STR];\n\n  function findTaskIndex(existingTasks, eventType, listenerFn, capture) {\n    for (var _i = 0; _i < existingTasks.length; _i++) {\n      var task = existingTasks[_i];\n\n      if (task.eventType === eventType && task.listenerFn === listenerFn && task.capture === capture) {\n        return _i;\n      }\n    }\n\n    return -1;\n  }\n\n  function isCapture(options) {\n    var capture;\n\n    if (typeof options === 'boolean') {\n      capture = options;\n    } else {\n      capture = options ? !!options.capture : false;\n    }\n\n    return capture;\n  }\n\n  function createListenerWrapper(target, eventType, listenerFn, options) {\n    var eventSymbol = eventTypeSymbols[eventType];\n    if (!eventSymbol) return listenerFn;\n    var existingTasks = target[eventSymbol];\n    var capture = isCapture(options);\n\n    if (existingTasks) {\n      var taskIndex = findTaskIndex(existingTasks, eventType, listenerFn, capture);\n\n      if (taskIndex !== -1) {\n        var _task = existingTasks[taskIndex];\n        return _task.wrappingFn;\n      }\n    } else {\n      existingTasks = target[eventSymbol] = [];\n    }\n\n    var task = {\n      source: EVENT_TARGET,\n      eventType: eventType,\n      listenerFn: listenerFn,\n      capture: capture,\n      wrappingFn: wrappingFn\n    };\n    existingTasks.push(task);\n\n    function wrappingFn() {\n      var event = arguments[0];\n      task.target = event.target;\n      callback(SCHEDULE, task);\n      var result;\n\n      try {\n        result = listenerFn.apply(this, arguments);\n      } finally {\n        callback(INVOKE, task);\n      }\n\n      return result;\n    }\n\n    return wrappingFn;\n  }\n\n  function getWrappingFn(target, eventType, listenerFn, options) {\n    var eventSymbol = eventTypeSymbols[eventType];\n    var existingTasks = target[eventSymbol];\n\n    if (existingTasks) {\n      var capture = isCapture(options);\n      var taskIndex = findTaskIndex(existingTasks, eventType, listenerFn, capture);\n\n      if (taskIndex !== -1) {\n        var task = existingTasks[taskIndex];\n        existingTasks.splice(taskIndex, 1);\n\n        if (existingTasks.length === 0) {\n          target[eventSymbol] = undefined;\n        }\n\n        return task.wrappingFn;\n      }\n    }\n\n    return listenerFn;\n  }\n\n  proto[ADD_EVENT_LISTENER_STR] = function (eventType, listenerFn, optionsOrCapture) {\n    var target = this;\n\n    if (!shouldInstrumentEvent(target, eventType, listenerFn)) {\n      return nativeAddEventListener.apply(target, arguments);\n    }\n\n    var wrappingListenerFn = createListenerWrapper(target, eventType, listenerFn, optionsOrCapture);\n    var args = Array.prototype.slice.call(arguments);\n    args[1] = wrappingListenerFn;\n    return nativeAddEventListener.apply(target, args);\n  };\n\n  proto[REMOVE_EVENT_LISTENER_STR] = function (eventType, listenerFn, optionsOrCapture) {\n    var target = this;\n\n    if (!shouldInstrumentEvent(target, eventType, listenerFn)) {\n      return nativeRemoveEventListener.apply(target, arguments);\n    }\n\n    var wrappingFn = getWrappingFn(target, eventType, listenerFn, optionsOrCapture);\n    var args = Array.prototype.slice.call(arguments);\n    args[1] = wrappingFn;\n    return nativeRemoveEventListener.apply(target, args);\n  };\n}","import { patchXMLHttpRequest } from './xhr-patch';\nimport { patchFetch } from './fetch-patch';\nimport { patchHistory } from './history-patch';\nimport { patchEventTarget } from './event-target-patch';\nimport EventHandler from '../event-handler';\nimport { HISTORY, FETCH, XMLHTTPREQUEST, EVENT_TARGET } from '../constants';\nvar patchEventHandler = new EventHandler();\nvar alreadyPatched = false;\n\nfunction patchAll() {\n  if (!alreadyPatched) {\n    alreadyPatched = true;\n    patchXMLHttpRequest(function (event, task) {\n      patchEventHandler.send(XMLHTTPREQUEST, [event, task]);\n    });\n    patchFetch(function (event, task) {\n      patchEventHandler.send(FETCH, [event, task]);\n    });\n    patchHistory(function (event, task) {\n      patchEventHandler.send(HISTORY, [event, task]);\n    });\n    patchEventTarget(function (event, task) {\n      patchEventHandler.send(EVENT_TARGET, [event, task]);\n    });\n  }\n\n  return patchEventHandler;\n}\n\nexport { patchAll, patchEventHandler };","import { Promise } from '../polyfills';\nimport { globalState } from './patch-utils';\nimport { SCHEDULE, INVOKE, FETCH } from '../constants';\nimport { scheduleMicroTask } from '../utils';\nexport function patchFetch(callback) {\n  if (!window.fetch || !window.Request) {\n    return;\n  }\n\n  function scheduleTask(task) {\n    task.state = SCHEDULE;\n    callback(SCHEDULE, task);\n  }\n\n  function invokeTask(task) {\n    task.state = INVOKE;\n    callback(INVOKE, task);\n  }\n\n  var nativeFetch = window.fetch;\n\n  window.fetch = function (input, init) {\n    var fetchSelf = this;\n    var args = arguments;\n    var request, url;\n\n    if (typeof input === 'string') {\n      request = new Request(input, init);\n      url = input;\n    } else if (input) {\n      request = input;\n      url = request.url;\n    } else {\n      return nativeFetch.apply(fetchSelf, args);\n    }\n\n    var task = {\n      source: FETCH,\n      state: '',\n      type: 'macroTask',\n      data: {\n        target: request,\n        method: request.method,\n        url: url,\n        aborted: false\n      }\n    };\n    return new Promise(function (resolve, reject) {\n      globalState.fetchInProgress = true;\n      scheduleTask(task);\n      var promise;\n\n      try {\n        promise = nativeFetch.apply(fetchSelf, [request]);\n      } catch (error) {\n        reject(error);\n        task.data.error = error;\n        invokeTask(task);\n        globalState.fetchInProgress = false;\n        return;\n      }\n\n      promise.then(function (response) {\n        resolve(response);\n        scheduleMicroTask(function () {\n          task.data.response = response;\n          invokeTask(task);\n        });\n      }, function (error) {\n        reject(error);\n        scheduleMicroTask(function () {\n          task.data.error = error;\n          invokeTask(task);\n        });\n      });\n      globalState.fetchInProgress = false;\n    });\n  };\n}","import { INVOKE, HISTORY } from '../constants';\nexport function patchHistory(callback) {\n  if (!window.history) {\n    return;\n  }\n\n  var nativePushState = history.pushState;\n\n  if (typeof nativePushState === 'function') {\n    history.pushState = function (state, title, url) {\n      var task = {\n        source: HISTORY,\n        data: {\n          state: state,\n          title: title,\n          url: url\n        }\n      };\n      callback(INVOKE, task);\n      nativePushState.apply(this, arguments);\n    };\n  }\n}","import { checkSameOrigin, isDtHeaderValid, parseDtHeaderValue, getDtHeaderValue, getTSHeaderValue, stripQueryStringFromUrl, setRequestHeader } from '../common/utils';\nimport { Url } from '../common/url';\nimport { patchEventHandler } from '../common/patching';\nimport { globalState } from '../common/patching/patch-utils';\nimport { SCHEDULE, INVOKE, TRANSACTION_END, AFTER_EVENT, FETCH, HISTORY, XMLHTTPREQUEST, EVENT_TARGET, HTTP_REQUEST_TYPE, USER_INTERACTION, OUTCOME_FAILURE, OUTCOME_SUCCESS } from '../common/constants';\nimport { truncateModel, SPAN_MODEL, TRANSACTION_MODEL } from '../common/truncate';\nimport { __DEV__ } from '../state';\nvar SIMILAR_SPAN_TO_TRANSACTION_RATIO = 0.05;\nvar TRANSACTION_DURATION_THRESHOLD = 60000;\nexport function groupSmallContinuouslySimilarSpans(originalSpans, transDuration, threshold) {\n  originalSpans.sort(function (spanA, spanB) {\n    return spanA._start - spanB._start;\n  });\n  var spans = [];\n  var lastCount = 1;\n  originalSpans.forEach(function (span, index) {\n    if (spans.length === 0) {\n      spans.push(span);\n    } else {\n      var lastSpan = spans[spans.length - 1];\n      var isContinuouslySimilar = lastSpan.type === span.type && lastSpan.subtype === span.subtype && lastSpan.action === span.action && lastSpan.name === span.name && span.duration() / transDuration < threshold && (span._start - lastSpan._end) / transDuration < threshold;\n      var isLastSpan = originalSpans.length === index + 1;\n\n      if (isContinuouslySimilar) {\n        lastCount++;\n        lastSpan._end = span._end;\n      }\n\n      if (lastCount > 1 && (!isContinuouslySimilar || isLastSpan)) {\n        lastSpan.name = lastCount + 'x ' + lastSpan.name;\n        lastCount = 1;\n      }\n\n      if (!isContinuouslySimilar) {\n        spans.push(span);\n      }\n    }\n  });\n  return spans;\n}\nexport function adjustTransaction(transaction) {\n  if (transaction.sampled) {\n    var filterdSpans = transaction.spans.filter(function (span) {\n      return span.duration() > 0 && span._start >= transaction._start && span._end <= transaction._end;\n    });\n\n    if (transaction.isManaged()) {\n      var duration = transaction.duration();\n      var similarSpans = groupSmallContinuouslySimilarSpans(filterdSpans, duration, SIMILAR_SPAN_TO_TRANSACTION_RATIO);\n      transaction.spans = similarSpans;\n    } else {\n      transaction.spans = filterdSpans;\n    }\n  } else {\n    transaction.resetFields();\n  }\n\n  return transaction;\n}\n\nvar PerformanceMonitoring = function () {\n  function PerformanceMonitoring(apmServer, configService, loggingService, transactionService) {\n    this._apmServer = apmServer;\n    this._configService = configService;\n    this._logginService = loggingService;\n    this._transactionService = transactionService;\n  }\n\n  var _proto = PerformanceMonitoring.prototype;\n\n  _proto.init = function init(flags) {\n    var _this = this;\n\n    if (flags === void 0) {\n      flags = {};\n    }\n\n    this._configService.events.observe(TRANSACTION_END + AFTER_EVENT, function (tr) {\n      var payload = _this.createTransactionPayload(tr);\n\n      if (payload) {\n        _this._apmServer.addTransaction(payload);\n      }\n    });\n\n    if (flags[HISTORY]) {\n      patchEventHandler.observe(HISTORY, this.getHistorySub());\n    }\n\n    if (flags[XMLHTTPREQUEST]) {\n      patchEventHandler.observe(XMLHTTPREQUEST, this.getXHRSub());\n    }\n\n    if (flags[FETCH]) {\n      patchEventHandler.observe(FETCH, this.getFetchSub());\n    }\n\n    if (flags[EVENT_TARGET]) {\n      patchEventHandler.observe(EVENT_TARGET, this.getEventTargetSub());\n    }\n  };\n\n  _proto.getEventTargetSub = function getEventTargetSub() {\n    var transactionService = this._transactionService;\n    return function (event, task) {\n      if (event === SCHEDULE && task.source === EVENT_TARGET && task.eventType === 'click') {\n        var target = task.target;\n        var tagName = target.tagName.toLowerCase();\n        var transactionName = tagName;\n\n        if (!!target.dataset.transactionName) {\n          transactionName = target.dataset.transactionName;\n        } else {\n          var name = target.getAttribute('name');\n\n          if (!!name) {\n            transactionName = tagName + \"[\\\"\" + name + \"\\\"]\";\n          }\n        }\n\n        var tr = transactionService.startTransaction(\"Click - \" + transactionName, USER_INTERACTION, {\n          managed: true,\n          canReuse: true,\n          reuseThreshold: 300\n        });\n\n        if (tr) {\n          var classes = target.getAttribute('class');\n\n          if (classes) {\n            tr.addContext({\n              custom: {\n                classes: classes\n              }\n            });\n          }\n        }\n      }\n    };\n  };\n\n  _proto.getHistorySub = function getHistorySub() {\n    var transactionService = this._transactionService;\n    return function (event, task) {\n      if (task.source === HISTORY && event === INVOKE) {\n        transactionService.startTransaction(task.data.title, 'route-change', {\n          managed: true,\n          canReuse: true\n        });\n      }\n    };\n  };\n\n  _proto.getXHRSub = function getXHRSub() {\n    var _this2 = this;\n\n    return function (event, task) {\n      if (task.source === XMLHTTPREQUEST && !globalState.fetchInProgress) {\n        _this2.processAPICalls(event, task);\n      }\n    };\n  };\n\n  _proto.getFetchSub = function getFetchSub() {\n    var _this3 = this;\n\n    return function (event, task) {\n      if (task.source === FETCH) {\n        _this3.processAPICalls(event, task);\n      }\n    };\n  };\n\n  _proto.processAPICalls = function processAPICalls(event, task) {\n    var configService = this._configService;\n    var transactionService = this._transactionService;\n\n    if (event === SCHEDULE && task.data) {\n      var data = task.data;\n      var requestUrl = new Url(data.url);\n      var spanName = data.method + ' ' + (requestUrl.relative ? requestUrl.path : stripQueryStringFromUrl(requestUrl.href));\n\n      if (!transactionService.getCurrentTransaction()) {\n        transactionService.startTransaction(spanName, HTTP_REQUEST_TYPE, {\n          managed: true\n        });\n      }\n\n      var span = transactionService.startSpan(spanName, 'external.http', {\n        blocking: true\n      });\n\n      if (!span) {\n        return;\n      }\n\n      var isDtEnabled = configService.get('distributedTracing');\n      var dtOrigins = configService.get('distributedTracingOrigins');\n      var currentUrl = new Url(window.location.href);\n      var isSameOrigin = checkSameOrigin(requestUrl.origin, currentUrl.origin) || checkSameOrigin(requestUrl.origin, dtOrigins);\n      var target = data.target;\n\n      if (isDtEnabled && isSameOrigin && target) {\n        this.injectDtHeader(span, target);\n        var propagateTracestate = configService.get('propagateTracestate');\n\n        if (propagateTracestate) {\n          this.injectTSHeader(span, target);\n        }\n      } else if (__DEV__) {\n        this._logginService.debug(\"Could not inject distributed tracing header to the request origin ('\" + requestUrl.origin + \"') from the current origin ('\" + currentUrl.origin + \"')\");\n      }\n\n      if (data.sync) {\n        span.sync = data.sync;\n      }\n\n      data.span = span;\n    } else if (event === INVOKE) {\n      var _data = task.data;\n\n      if (_data && _data.span) {\n        var _span = _data.span,\n            response = _data.response,\n            _target = _data.target;\n        var status;\n\n        if (response) {\n          status = response.status;\n        } else {\n          status = _target.status;\n        }\n\n        var outcome;\n\n        if (_data.status != 'abort') {\n          if (status >= 400 || status == 0) {\n            outcome = OUTCOME_FAILURE;\n          } else {\n            outcome = OUTCOME_SUCCESS;\n          }\n        }\n\n        _span.outcome = outcome;\n        var tr = transactionService.getCurrentTransaction();\n\n        if (tr && tr.type === HTTP_REQUEST_TYPE) {\n          tr.outcome = outcome;\n        }\n\n        transactionService.endSpan(_span, _data);\n      }\n    }\n  };\n\n  _proto.injectDtHeader = function injectDtHeader(span, target) {\n    var headerName = this._configService.get('distributedTracingHeaderName');\n\n    var headerValue = getDtHeaderValue(span);\n    var isHeaderValid = isDtHeaderValid(headerValue);\n\n    if (isHeaderValid && headerValue && headerName) {\n      setRequestHeader(target, headerName, headerValue);\n    }\n  };\n\n  _proto.injectTSHeader = function injectTSHeader(span, target) {\n    var headerValue = getTSHeaderValue(span);\n\n    if (headerValue) {\n      setRequestHeader(target, 'tracestate', headerValue);\n    }\n  };\n\n  _proto.extractDtHeader = function extractDtHeader(target) {\n    var configService = this._configService;\n    var headerName = configService.get('distributedTracingHeaderName');\n\n    if (target) {\n      return parseDtHeaderValue(target[headerName]);\n    }\n  };\n\n  _proto.filterTransaction = function filterTransaction(tr) {\n    var duration = tr.duration();\n\n    if (!duration) {\n      if (__DEV__) {\n        var message = \"transaction(\" + tr.id + \", \" + tr.name + \") was discarded! \";\n\n        if (duration === 0) {\n          message += \"Transaction duration is 0\";\n        } else {\n          message += \"Transaction wasn't ended\";\n        }\n\n        this._logginService.debug(message);\n      }\n\n      return false;\n    }\n\n    if (tr.isManaged()) {\n      if (duration > TRANSACTION_DURATION_THRESHOLD) {\n        if (__DEV__) {\n          this._logginService.debug(\"transaction(\" + tr.id + \", \" + tr.name + \") was discarded! Transaction duration (\" + duration + \") is greater than managed transaction threshold (\" + TRANSACTION_DURATION_THRESHOLD + \")\");\n        }\n\n        return false;\n      }\n\n      if (tr.sampled && tr.spans.length === 0) {\n        if (__DEV__) {\n          this._logginService.debug(\"transaction(\" + tr.id + \", \" + tr.name + \") was discarded! Transaction does not have any spans\");\n        }\n\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  _proto.createTransactionDataModel = function createTransactionDataModel(transaction) {\n    var transactionStart = transaction._start;\n    var spans = transaction.spans.map(function (span) {\n      var spanData = {\n        id: span.id,\n        transaction_id: transaction.id,\n        parent_id: span.parentId || transaction.id,\n        trace_id: transaction.traceId,\n        name: span.name,\n        type: span.type,\n        subtype: span.subtype,\n        action: span.action,\n        sync: span.sync,\n        start: parseInt(span._start - transactionStart),\n        duration: span.duration(),\n        context: span.context,\n        outcome: span.outcome,\n        sample_rate: span.sampleRate\n      };\n      return truncateModel(SPAN_MODEL, spanData);\n    });\n    var transactionData = {\n      id: transaction.id,\n      trace_id: transaction.traceId,\n      session: transaction.session,\n      name: transaction.name,\n      type: transaction.type,\n      duration: transaction.duration(),\n      spans: spans,\n      context: transaction.context,\n      marks: transaction.marks,\n      breakdown: transaction.breakdownTimings,\n      span_count: {\n        started: spans.length\n      },\n      sampled: transaction.sampled,\n      sample_rate: transaction.sampleRate,\n      experience: transaction.experience,\n      outcome: transaction.outcome\n    };\n    return truncateModel(TRANSACTION_MODEL, transactionData);\n  };\n\n  _proto.createTransactionPayload = function createTransactionPayload(transaction) {\n    var adjustedTransaction = adjustTransaction(transaction);\n    var filtered = this.filterTransaction(adjustedTransaction);\n\n    if (filtered) {\n      return this.createTransactionDataModel(transaction);\n    }\n  };\n\n  return PerformanceMonitoring;\n}();\n\nexport { PerformanceMonitoring as default };","import { getDuration, PERF } from '../common/utils';\nimport { PAGE_LOAD, TRUNCATED_TYPE } from '../common/constants';\nvar pageLoadBreakdowns = [['domainLookupStart', 'domainLookupEnd', 'DNS'], ['connectStart', 'connectEnd', 'TCP'], ['requestStart', 'responseStart', 'Request'], ['responseStart', 'responseEnd', 'Response'], ['domLoading', 'domComplete', 'Processing'], ['loadEventStart', 'loadEventEnd', 'Load']];\n\nfunction getValue(value) {\n  return {\n    value: value\n  };\n}\n\nfunction calculateSelfTime(transaction) {\n  var spans = transaction.spans,\n      _start = transaction._start,\n      _end = transaction._end;\n\n  if (spans.length === 0) {\n    return transaction.duration();\n  }\n\n  spans.sort(function (span1, span2) {\n    return span1._start - span2._start;\n  });\n  var span = spans[0];\n  var spanEnd = span._end;\n  var spanStart = span._start;\n  var lastContinuousEnd = spanEnd;\n  var selfTime = spanStart - _start;\n\n  for (var i = 1; i < spans.length; i++) {\n    span = spans[i];\n    spanStart = span._start;\n    spanEnd = span._end;\n\n    if (spanStart > lastContinuousEnd) {\n      selfTime += spanStart - lastContinuousEnd;\n      lastContinuousEnd = spanEnd;\n    } else if (spanEnd > lastContinuousEnd) {\n      lastContinuousEnd = spanEnd;\n    }\n  }\n\n  if (lastContinuousEnd < _end) {\n    selfTime += _end - lastContinuousEnd;\n  }\n\n  return selfTime;\n}\n\nfunction groupSpans(transaction) {\n  var spanMap = {};\n  var transactionSelfTime = calculateSelfTime(transaction);\n  spanMap['app'] = {\n    count: 1,\n    duration: transactionSelfTime\n  };\n  var spans = transaction.spans;\n\n  for (var i = 0; i < spans.length; i++) {\n    var span = spans[i];\n    var duration = span.duration();\n\n    if (duration === 0 || duration == null) {\n      continue;\n    }\n\n    var type = span.type,\n        subtype = span.subtype;\n    var key = type.replace(TRUNCATED_TYPE, '');\n\n    if (subtype) {\n      key += '.' + subtype;\n    }\n\n    if (!spanMap[key]) {\n      spanMap[key] = {\n        duration: 0,\n        count: 0\n      };\n    }\n\n    spanMap[key].count++;\n    spanMap[key].duration += duration;\n  }\n\n  return spanMap;\n}\n\nfunction getSpanBreakdown(transactionDetails, _ref) {\n  var details = _ref.details,\n      _ref$count = _ref.count,\n      count = _ref$count === void 0 ? 1 : _ref$count,\n      duration = _ref.duration;\n  return {\n    transaction: transactionDetails,\n    span: details,\n    samples: {\n      'span.self_time.count': getValue(count),\n      'span.self_time.sum.us': getValue(duration)\n    }\n  };\n}\n\nexport function captureBreakdown(transaction, timings) {\n  if (timings === void 0) {\n    timings = PERF.timing;\n  }\n\n  var breakdowns = [];\n  var trDuration = transaction.duration();\n  var name = transaction.name,\n      type = transaction.type,\n      sampled = transaction.sampled;\n  var transactionDetails = {\n    name: name,\n    type: type\n  };\n  breakdowns.push({\n    transaction: transactionDetails,\n    samples: {\n      'transaction.duration.count': getValue(1),\n      'transaction.duration.sum.us': getValue(trDuration),\n      'transaction.breakdown.count': getValue(sampled ? 1 : 0)\n    }\n  });\n\n  if (!sampled) {\n    return breakdowns;\n  }\n\n  if (type === PAGE_LOAD && timings) {\n    for (var i = 0; i < pageLoadBreakdowns.length; i++) {\n      var current = pageLoadBreakdowns[i];\n      var start = timings[current[0]];\n      var end = timings[current[1]];\n      var duration = getDuration(start, end);\n\n      if (duration === 0 || duration == null) {\n        continue;\n      }\n\n      breakdowns.push(getSpanBreakdown(transactionDetails, {\n        details: {\n          type: current[2]\n        },\n        duration: duration\n      }));\n    }\n  } else {\n    var spanMap = groupSpans(transaction);\n    Object.keys(spanMap).forEach(function (key) {\n      var _key$split = key.split('.'),\n          type = _key$split[0],\n          subtype = _key$split[1];\n\n      var _spanMap$key = spanMap[key],\n          duration = _spanMap$key.duration,\n          count = _spanMap$key.count;\n      breakdowns.push(getSpanBreakdown(transactionDetails, {\n        details: {\n          type: type,\n          subtype: subtype\n        },\n        duration: duration,\n        count: count\n      }));\n    });\n  }\n\n  return breakdowns;\n}","function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport Span from './span';\nimport SpanBase from './span-base';\nimport { generateRandomId, merge, now, getTime, extend, removeInvalidChars } from '../common/utils';\nimport { REUSABILITY_THRESHOLD, TRUNCATED_TYPE } from '../common/constants';\nimport { captureBreakdown as _captureBreakdown } from './breakdown';\n\nvar Transaction = function (_SpanBase) {\n  _inheritsLoose(Transaction, _SpanBase);\n\n  function Transaction(name, type, options) {\n    var _this;\n\n    _this = _SpanBase.call(this, name, type, options) || this;\n    _this.traceId = generateRandomId();\n    _this.marks = undefined;\n    _this.spans = [];\n    _this._activeSpans = {};\n    _this._activeTasks = new Set();\n    _this.blocked = false;\n    _this.captureTimings = false;\n    _this.breakdownTimings = [];\n    _this.sampleRate = _this.options.transactionSampleRate;\n    _this.sampled = Math.random() <= _this.sampleRate;\n    return _this;\n  }\n\n  var _proto = Transaction.prototype;\n\n  _proto.addMarks = function addMarks(obj) {\n    this.marks = merge(this.marks || {}, obj);\n  };\n\n  _proto.mark = function mark(key) {\n    var skey = removeInvalidChars(key);\n\n    var markTime = now() - this._start;\n\n    var custom = {};\n    custom[skey] = markTime;\n    this.addMarks({\n      custom: custom\n    });\n  };\n\n  _proto.canReuse = function canReuse() {\n    var threshold = this.options.reuseThreshold || REUSABILITY_THRESHOLD;\n    return !!this.options.canReuse && !this.ended && now() - this._start < threshold;\n  };\n\n  _proto.redefine = function redefine(name, type, options) {\n    if (name) {\n      this.name = name;\n    }\n\n    if (type) {\n      this.type = type;\n    }\n\n    if (options) {\n      extend(this.options, options);\n    }\n  };\n\n  _proto.startSpan = function startSpan(name, type, options) {\n    var _this2 = this;\n\n    if (this.ended) {\n      return;\n    }\n\n    var opts = extend({}, options);\n\n    opts.onEnd = function (trc) {\n      _this2._onSpanEnd(trc);\n    };\n\n    opts.traceId = this.traceId;\n    opts.sampled = this.sampled;\n    opts.sampleRate = this.sampleRate;\n\n    if (!opts.parentId) {\n      opts.parentId = this.id;\n    }\n\n    var span = new Span(name, type, opts);\n    this._activeSpans[span.id] = span;\n\n    if (opts.blocking) {\n      this.addTask(span.id);\n    }\n\n    return span;\n  };\n\n  _proto.isFinished = function isFinished() {\n    return !this.blocked && this._activeTasks.size === 0;\n  };\n\n  _proto.detectFinish = function detectFinish() {\n    if (this.isFinished()) this.end();\n  };\n\n  _proto.end = function end(endTime) {\n    if (this.ended) {\n      return;\n    }\n\n    this.ended = true;\n    this._end = getTime(endTime);\n\n    for (var sid in this._activeSpans) {\n      var span = this._activeSpans[sid];\n      span.type = span.type + TRUNCATED_TYPE;\n      span.end(endTime);\n    }\n\n    this.callOnEnd();\n  };\n\n  _proto.captureBreakdown = function captureBreakdown() {\n    this.breakdownTimings = _captureBreakdown(this);\n  };\n\n  _proto.block = function block(flag) {\n    this.blocked = flag;\n\n    if (!this.blocked) {\n      this.detectFinish();\n    }\n  };\n\n  _proto.addTask = function addTask(taskId) {\n    if (!taskId) {\n      taskId = 'task-' + generateRandomId(16);\n    }\n\n    this._activeTasks.add(taskId);\n\n    return taskId;\n  };\n\n  _proto.removeTask = function removeTask(taskId) {\n    var deleted = this._activeTasks.delete(taskId);\n\n    deleted && this.detectFinish();\n  };\n\n  _proto.resetFields = function resetFields() {\n    this.spans = [];\n    this.sampleRate = 0;\n  };\n\n  _proto._onSpanEnd = function _onSpanEnd(span) {\n    this.spans.push(span);\n    delete this._activeSpans[span.id];\n    this.removeTask(span.id);\n  };\n\n  _proto.isManaged = function isManaged() {\n    return !!this.options.managed;\n  };\n\n  return Transaction;\n}(SpanBase);\n\nexport default Transaction;","import { LONG_TASK, LARGEST_CONTENTFUL_PAINT, FIRST_CONTENTFUL_PAINT, FIRST_INPUT, LAYOUT_SHIFT } from '../common/constants';\nimport { noop, PERF } from '../common/utils';\nimport Span from './span';\nexport var metrics = {\n  fid: 0,\n  fcp: 0,\n  tbt: {\n    start: Infinity,\n    duration: 0\n  },\n  cls: {\n    score: 0,\n    firstEntryTime: Number.NEGATIVE_INFINITY,\n    prevEntryTime: Number.NEGATIVE_INFINITY,\n    currentSessionScore: 0\n  },\n  longtask: {\n    count: 0,\n    duration: 0,\n    max: 0\n  }\n};\nvar LONG_TASK_THRESHOLD = 50;\nexport function createLongTaskSpans(longtasks, agg) {\n  var spans = [];\n\n  for (var i = 0; i < longtasks.length; i++) {\n    var _longtasks$i = longtasks[i],\n        name = _longtasks$i.name,\n        startTime = _longtasks$i.startTime,\n        duration = _longtasks$i.duration,\n        attribution = _longtasks$i.attribution;\n    var end = startTime + duration;\n    var span = new Span(\"Longtask(\" + name + \")\", LONG_TASK, {\n      startTime: startTime\n    });\n    agg.count++;\n    agg.duration += duration;\n    agg.max = Math.max(duration, agg.max);\n\n    if (attribution.length > 0) {\n      var _attribution$ = attribution[0],\n          _name = _attribution$.name,\n          containerType = _attribution$.containerType,\n          containerName = _attribution$.containerName,\n          containerId = _attribution$.containerId;\n      var customContext = {\n        attribution: _name,\n        type: containerType\n      };\n\n      if (containerName) {\n        customContext.name = containerName;\n      }\n\n      if (containerId) {\n        customContext.id = containerId;\n      }\n\n      span.addContext({\n        custom: customContext\n      });\n    }\n\n    span.end(end);\n    spans.push(span);\n  }\n\n  return spans;\n}\nexport function createFirstInputDelaySpan(fidEntries) {\n  var firstInput = fidEntries[0];\n\n  if (firstInput) {\n    var startTime = firstInput.startTime,\n        processingStart = firstInput.processingStart;\n    var span = new Span('First Input Delay', FIRST_INPUT, {\n      startTime: startTime\n    });\n    span.end(processingStart);\n    return span;\n  }\n}\nexport function createTotalBlockingTimeSpan(tbtObject) {\n  var start = tbtObject.start,\n      duration = tbtObject.duration;\n  var tbtSpan = new Span('Total Blocking Time', LONG_TASK, {\n    startTime: start\n  });\n  tbtSpan.end(start + duration);\n  return tbtSpan;\n}\nexport function calculateTotalBlockingTime(longtaskEntries) {\n  longtaskEntries.forEach(function (entry) {\n    var name = entry.name,\n        startTime = entry.startTime,\n        duration = entry.duration;\n\n    if (startTime < metrics.fcp) {\n      return;\n    }\n\n    if (name !== 'self' && name.indexOf('same-origin') === -1) {\n      return;\n    }\n\n    metrics.tbt.start = Math.min(metrics.tbt.start, startTime);\n    var blockingTime = duration - LONG_TASK_THRESHOLD;\n\n    if (blockingTime > 0) {\n      metrics.tbt.duration += blockingTime;\n    }\n  });\n}\nexport function calculateCumulativeLayoutShift(clsEntries) {\n  clsEntries.forEach(function (entry) {\n    if (!entry.hadRecentInput && entry.value) {\n      var shouldCreateNewSession = entry.startTime - metrics.cls.firstEntryTime > 5000 || entry.startTime - metrics.cls.prevEntryTime > 1000;\n\n      if (shouldCreateNewSession) {\n        metrics.cls.firstEntryTime = entry.startTime;\n        metrics.cls.currentSessionScore = 0;\n      }\n\n      metrics.cls.prevEntryTime = entry.startTime;\n      metrics.cls.currentSessionScore += entry.value;\n      metrics.cls.score = Math.max(metrics.cls.score, metrics.cls.currentSessionScore);\n    }\n  });\n}\nexport function captureObserverEntries(list, _ref) {\n  var isHardNavigation = _ref.isHardNavigation,\n      trStart = _ref.trStart;\n  var longtaskEntries = list.getEntriesByType(LONG_TASK).filter(function (entry) {\n    return entry.startTime >= trStart;\n  });\n  var longTaskSpans = createLongTaskSpans(longtaskEntries, metrics.longtask);\n  var result = {\n    spans: longTaskSpans,\n    marks: {}\n  };\n\n  if (!isHardNavigation) {\n    return result;\n  }\n\n  var lcpEntries = list.getEntriesByType(LARGEST_CONTENTFUL_PAINT);\n  var lastLcpEntry = lcpEntries[lcpEntries.length - 1];\n\n  if (lastLcpEntry) {\n    var lcp = parseInt(lastLcpEntry.startTime);\n    metrics.lcp = lcp;\n    result.marks.largestContentfulPaint = lcp;\n  }\n\n  var timing = PERF.timing;\n  var unloadDiff = timing.fetchStart - timing.navigationStart;\n  var fcpEntry = list.getEntriesByName(FIRST_CONTENTFUL_PAINT)[0];\n\n  if (fcpEntry) {\n    var fcp = parseInt(unloadDiff >= 0 ? fcpEntry.startTime - unloadDiff : fcpEntry.startTime);\n    metrics.fcp = fcp;\n    result.marks.firstContentfulPaint = fcp;\n  }\n\n  var fidEntries = list.getEntriesByType(FIRST_INPUT);\n  var fidSpan = createFirstInputDelaySpan(fidEntries);\n\n  if (fidSpan) {\n    metrics.fid = fidSpan.duration();\n    result.spans.push(fidSpan);\n  }\n\n  calculateTotalBlockingTime(longtaskEntries);\n  var clsEntries = list.getEntriesByType(LAYOUT_SHIFT);\n  calculateCumulativeLayoutShift(clsEntries);\n  return result;\n}\nexport var PerfEntryRecorder = function () {\n  function PerfEntryRecorder(callback) {\n    this.po = {\n      observe: noop,\n      disconnect: noop\n    };\n\n    if (window.PerformanceObserver) {\n      this.po = new PerformanceObserver(callback);\n    }\n  }\n\n  var _proto = PerfEntryRecorder.prototype;\n\n  _proto.start = function start(type) {\n    try {\n      this.po.observe({\n        type: type,\n        buffered: true\n      });\n    } catch (_) {}\n  };\n\n  _proto.stop = function stop() {\n    this.po.disconnect();\n  };\n\n  return PerfEntryRecorder;\n}();","import { Promise } from '../common/polyfills';\nimport Transaction from './transaction';\nimport { PerfEntryRecorder, captureObserverEntries, metrics, createTotalBlockingTimeSpan } from './metrics';\nimport { extend, getEarliestSpan, getLatestNonXHRSpan, isPerfTypeSupported, generateRandomId } from '../common/utils';\nimport { captureNavigation } from './capture-navigation';\nimport { PAGE_LOAD, NAME_UNKNOWN, TRANSACTION_START, TRANSACTION_END, TEMPORARY_TYPE, TRANSACTION_TYPE_ORDER, LARGEST_CONTENTFUL_PAINT, LONG_TASK, PAINT, TRUNCATED_TYPE, FIRST_INPUT, LAYOUT_SHIFT, SESSION_TIMEOUT } from '../common/constants';\nimport { addTransactionContext } from '../common/context';\nimport { __DEV__, state } from '../state';\nimport { slugifyUrl } from '../common/url';\n\nvar TransactionService = function () {\n  function TransactionService(logger, config) {\n    var _this = this;\n\n    this._config = config;\n    this._logger = logger;\n    this.currentTransaction = undefined;\n    this.respIntervalId = undefined;\n    this.recorder = new PerfEntryRecorder(function (list) {\n      var tr = _this.getCurrentTransaction();\n\n      if (tr && tr.captureTimings) {\n        var _tr$spans;\n\n        var isHardNavigation = tr.type === PAGE_LOAD;\n\n        var _captureObserverEntri = captureObserverEntries(list, {\n          isHardNavigation: isHardNavigation,\n          trStart: isHardNavigation ? 0 : tr._start\n        }),\n            spans = _captureObserverEntri.spans,\n            marks = _captureObserverEntri.marks;\n\n        (_tr$spans = tr.spans).push.apply(_tr$spans, spans);\n\n        tr.addMarks({\n          agent: marks\n        });\n      }\n    });\n  }\n\n  var _proto = TransactionService.prototype;\n\n  _proto.createCurrentTransaction = function createCurrentTransaction(name, type, options) {\n    var tr = new Transaction(name, type, options);\n    this.currentTransaction = tr;\n    return tr;\n  };\n\n  _proto.getCurrentTransaction = function getCurrentTransaction() {\n    if (this.currentTransaction && !this.currentTransaction.ended) {\n      return this.currentTransaction;\n    }\n  };\n\n  _proto.createOptions = function createOptions(options) {\n    var config = this._config.config;\n    var presetOptions = {\n      transactionSampleRate: config.transactionSampleRate\n    };\n    var perfOptions = extend(presetOptions, options);\n\n    if (perfOptions.managed) {\n      perfOptions = extend({\n        pageLoadTraceId: config.pageLoadTraceId,\n        pageLoadSampled: config.pageLoadSampled,\n        pageLoadSpanId: config.pageLoadSpanId,\n        pageLoadTransactionName: config.pageLoadTransactionName\n      }, perfOptions);\n    }\n\n    return perfOptions;\n  };\n\n  _proto.startManagedTransaction = function startManagedTransaction(name, type, perfOptions) {\n    var tr = this.getCurrentTransaction();\n    var isRedefined = false;\n\n    if (!tr) {\n      tr = this.createCurrentTransaction(name, type, perfOptions);\n    } else if (tr.canReuse() && perfOptions.canReuse) {\n      var redefineType = tr.type;\n      var currentTypeOrder = TRANSACTION_TYPE_ORDER.indexOf(tr.type);\n      var redefineTypeOrder = TRANSACTION_TYPE_ORDER.indexOf(type);\n\n      if (currentTypeOrder >= 0 && redefineTypeOrder < currentTypeOrder) {\n        redefineType = type;\n      }\n\n      if (__DEV__) {\n        this._logger.debug(\"redefining transaction(\" + tr.id + \", \" + tr.name + \", \" + tr.type + \")\", 'to', \"(\" + (name || tr.name) + \", \" + redefineType + \")\", tr);\n      }\n\n      tr.redefine(name, redefineType, perfOptions);\n      isRedefined = true;\n    } else {\n      if (__DEV__) {\n        this._logger.debug(\"ending previous transaction(\" + tr.id + \", \" + tr.name + \")\", tr);\n      }\n\n      tr.end();\n      tr = this.createCurrentTransaction(name, type, perfOptions);\n    }\n\n    if (tr.type === PAGE_LOAD) {\n      if (!isRedefined) {\n        this.recorder.start(LARGEST_CONTENTFUL_PAINT);\n        this.recorder.start(PAINT);\n        this.recorder.start(FIRST_INPUT);\n        this.recorder.start(LAYOUT_SHIFT);\n      }\n\n      if (perfOptions.pageLoadTraceId) {\n        tr.traceId = perfOptions.pageLoadTraceId;\n      }\n\n      if (perfOptions.pageLoadSampled) {\n        tr.sampled = perfOptions.pageLoadSampled;\n      }\n\n      if (tr.name === NAME_UNKNOWN && perfOptions.pageLoadTransactionName) {\n        tr.name = perfOptions.pageLoadTransactionName;\n      }\n    }\n\n    if (!isRedefined && this._config.get('monitorLongtasks')) {\n      this.recorder.start(LONG_TASK);\n    }\n\n    if (tr.sampled) {\n      tr.captureTimings = true;\n    }\n\n    return tr;\n  };\n\n  _proto.startTransaction = function startTransaction(name, type, options) {\n    var _this2 = this;\n\n    var perfOptions = this.createOptions(options);\n    var tr;\n    var fireOnstartHook = true;\n\n    if (perfOptions.managed) {\n      var current = this.currentTransaction;\n      tr = this.startManagedTransaction(name, type, perfOptions);\n\n      if (current === tr) {\n        fireOnstartHook = false;\n      }\n    } else {\n      tr = new Transaction(name, type, perfOptions);\n    }\n\n    tr.onEnd = function () {\n      return _this2.handleTransactionEnd(tr);\n    };\n\n    if (fireOnstartHook) {\n      if (__DEV__) {\n        this._logger.debug(\"startTransaction(\" + tr.id + \", \" + tr.name + \", \" + tr.type + \")\");\n      }\n\n      this._config.events.send(TRANSACTION_START, [tr]);\n    }\n\n    return tr;\n  };\n\n  _proto.handleTransactionEnd = function handleTransactionEnd(tr) {\n    var _this3 = this;\n\n    this.recorder.stop();\n    var currentUrl = window.location.href;\n    return Promise.resolve().then(function () {\n      var name = tr.name,\n          type = tr.type;\n      var lastHiddenStart = state.lastHiddenStart;\n\n      if (lastHiddenStart >= tr._start) {\n        if (__DEV__) {\n          _this3._logger.debug(\"transaction(\" + tr.id + \", \" + name + \", \" + type + \") was discarded! The page was hidden during the transaction!\");\n        }\n\n        return;\n      }\n\n      if (_this3.shouldIgnoreTransaction(name) || type === TEMPORARY_TYPE) {\n        if (__DEV__) {\n          _this3._logger.debug(\"transaction(\" + tr.id + \", \" + name + \", \" + type + \") is ignored\");\n        }\n\n        return;\n      }\n\n      if (type === PAGE_LOAD) {\n        var pageLoadTransactionName = _this3._config.get('pageLoadTransactionName');\n\n        if (name === NAME_UNKNOWN && pageLoadTransactionName) {\n          tr.name = pageLoadTransactionName;\n        }\n\n        if (tr.captureTimings) {\n          var cls = metrics.cls,\n              fid = metrics.fid,\n              tbt = metrics.tbt,\n              longtask = metrics.longtask;\n\n          if (tbt.duration > 0) {\n            tr.spans.push(createTotalBlockingTimeSpan(tbt));\n          }\n\n          tr.experience = {};\n\n          if (isPerfTypeSupported(LONG_TASK)) {\n            tr.experience.tbt = tbt.duration;\n          }\n\n          if (isPerfTypeSupported(LAYOUT_SHIFT)) {\n            tr.experience.cls = cls.score;\n          }\n\n          if (fid > 0) {\n            tr.experience.fid = fid;\n          }\n\n          if (longtask.count > 0) {\n            tr.experience.longtask = {\n              count: longtask.count,\n              sum: longtask.duration,\n              max: longtask.max\n            };\n          }\n        }\n\n        _this3.setSession(tr);\n      }\n\n      if (tr.name === NAME_UNKNOWN) {\n        tr.name = slugifyUrl(currentUrl);\n      }\n\n      captureNavigation(tr);\n\n      _this3.adjustTransactionTime(tr);\n\n      var breakdownMetrics = _this3._config.get('breakdownMetrics');\n\n      if (breakdownMetrics) {\n        tr.captureBreakdown();\n      }\n\n      var configContext = _this3._config.get('context');\n\n      addTransactionContext(tr, configContext);\n\n      _this3._config.events.send(TRANSACTION_END, [tr]);\n\n      if (__DEV__) {\n        _this3._logger.debug(\"end transaction(\" + tr.id + \", \" + tr.name + \", \" + tr.type + \")\", tr);\n      }\n    }, function (err) {\n      if (__DEV__) {\n        _this3._logger.debug(\"error ending transaction(\" + tr.id + \", \" + tr.name + \")\", err);\n      }\n    });\n  };\n\n  _proto.setSession = function setSession(tr) {\n    var session = this._config.get('session');\n\n    if (session) {\n      if (typeof session == 'boolean') {\n        tr.session = {\n          id: generateRandomId(16),\n          sequence: 1\n        };\n      } else {\n        if (session.timestamp && Date.now() - session.timestamp > SESSION_TIMEOUT) {\n          tr.session = {\n            id: generateRandomId(16),\n            sequence: 1\n          };\n        } else {\n          tr.session = {\n            id: session.id,\n            sequence: session.sequence ? session.sequence + 1 : 1\n          };\n        }\n      }\n\n      var sessionConfig = {\n        session: {\n          id: tr.session.id,\n          sequence: tr.session.sequence,\n          timestamp: Date.now()\n        }\n      };\n\n      this._config.setConfig(sessionConfig);\n\n      this._config.setLocalConfig(sessionConfig, true);\n    }\n  };\n\n  _proto.adjustTransactionTime = function adjustTransactionTime(transaction) {\n    var spans = transaction.spans;\n    var earliestSpan = getEarliestSpan(spans);\n\n    if (earliestSpan && earliestSpan._start < transaction._start) {\n      transaction._start = earliestSpan._start;\n    }\n\n    var latestSpan = getLatestNonXHRSpan(spans);\n\n    if (latestSpan && latestSpan._end > transaction._end) {\n      transaction._end = latestSpan._end;\n    }\n\n    var transactionEnd = transaction._end;\n\n    for (var i = 0; i < spans.length; i++) {\n      var span = spans[i];\n\n      if (span._end > transactionEnd) {\n        span._end = transactionEnd;\n        span.type += TRUNCATED_TYPE;\n      }\n\n      if (span._start > transactionEnd) {\n        span._start = transactionEnd;\n      }\n    }\n  };\n\n  _proto.shouldIgnoreTransaction = function shouldIgnoreTransaction(transactionName) {\n    var ignoreList = this._config.get('ignoreTransactions');\n\n    if (ignoreList && ignoreList.length) {\n      for (var i = 0; i < ignoreList.length; i++) {\n        var element = ignoreList[i];\n\n        if (typeof element.test === 'function') {\n          if (element.test(transactionName)) {\n            return true;\n          }\n        } else if (element === transactionName) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  };\n\n  _proto.startSpan = function startSpan(name, type, options) {\n    var tr = this.getCurrentTransaction();\n\n    if (!tr) {\n      tr = this.createCurrentTransaction(undefined, TEMPORARY_TYPE, this.createOptions({\n        canReuse: true,\n        managed: true\n      }));\n    }\n\n    var span = tr.startSpan(name, type, options);\n\n    if (__DEV__) {\n      this._logger.debug(\"startSpan(\" + name + \", \" + span.type + \")\", \"on transaction(\" + tr.id + \", \" + tr.name + \")\");\n    }\n\n    return span;\n  };\n\n  _proto.endSpan = function endSpan(span, context) {\n    if (!span) {\n      return;\n    }\n\n    if (__DEV__) {\n      var tr = this.getCurrentTransaction();\n      tr && this._logger.debug(\"endSpan(\" + span.name + \", \" + span.type + \")\", \"on transaction(\" + tr.id + \", \" + tr.name + \")\");\n    }\n\n    span.end(null, context);\n  };\n\n  return TransactionService;\n}();\n\nexport default TransactionService;","import { isPlatformSupported, isBrowser, now } from './common/utils';\nimport { patchAll } from './common/patching';\nimport { state } from './state';\nvar enabled = false;\nexport function bootstrap() {\n  if (isPlatformSupported()) {\n    patchAll();\n    bootstrapPerf();\n    state.bootstrapTime = now();\n    enabled = true;\n  } else if (isBrowser) {\n    console.log('[Elastic APM] platform is not supported!');\n  }\n\n  return enabled;\n}\nexport function bootstrapPerf() {\n  if (document.visibilityState === 'hidden') {\n    state.lastHiddenStart = 0;\n  }\n\n  window.addEventListener('visibilitychange', function () {\n    if (document.visibilityState === 'hidden') {\n      state.lastHiddenStart = performance.now();\n    }\n  }, {\n    capture: true\n  });\n}","import { registerServices as registerErrorServices } from './error-logging';\nimport { registerServices as registerPerfServices } from './performance-monitoring';\nimport { ServiceFactory } from './common/service-factory';\nimport { isPlatformSupported, scheduleMicroTask, scheduleMacroTask, isBrowser } from './common/utils';\nimport { patchAll, patchEventHandler } from './common/patching';\nimport { PAGE_LOAD, ERROR, CONFIG_SERVICE, LOGGING_SERVICE, APM_SERVER } from './common/constants';\nimport { getInstrumentationFlags } from './common/instrument';\nimport afterFrame from './common/after-frame';\nimport { bootstrap } from './bootstrap';\nimport { createTracer } from './opentracing';\n\nfunction createServiceFactory() {\n  registerPerfServices();\n  registerErrorServices();\n  var serviceFactory = new ServiceFactory();\n  return serviceFactory;\n}\n\nexport { createServiceFactory, ServiceFactory, patchAll, patchEventHandler, isPlatformSupported, isBrowser, getInstrumentationFlags, createTracer, scheduleMicroTask, scheduleMacroTask, afterFrame, ERROR, PAGE_LOAD, CONFIG_SERVICE, LOGGING_SERVICE, APM_SERVER, bootstrap };","import PerformanceMonitoring from './performance-monitoring';\nimport TransactionService from './transaction-service';\nimport { APM_SERVER, CONFIG_SERVICE, LOGGING_SERVICE } from '../common/constants';\nimport { serviceCreators } from '../common/service-factory';\n\nfunction registerServices() {\n  serviceCreators['TransactionService'] = function (serviceFactory) {\n    var _serviceFactory$getSe = serviceFactory.getService([LOGGING_SERVICE, CONFIG_SERVICE]),\n        loggingService = _serviceFactory$getSe[0],\n        configService = _serviceFactory$getSe[1];\n\n    return new TransactionService(loggingService, configService);\n  };\n\n  serviceCreators['PerformanceMonitoring'] = function (serviceFactory) {\n    var _serviceFactory$getSe2 = serviceFactory.getService([APM_SERVER, CONFIG_SERVICE, LOGGING_SERVICE, 'TransactionService']),\n        apmServer = _serviceFactory$getSe2[0],\n        configService = _serviceFactory$getSe2[1],\n        loggingService = _serviceFactory$getSe2[2],\n        transactionService = _serviceFactory$getSe2[3];\n\n    return new PerformanceMonitoring(apmServer, configService, loggingService, transactionService);\n  };\n}\n\nexport { registerServices };","import ErrorLogging from './error-logging';\nimport { CONFIG_SERVICE, APM_SERVER } from '../common/constants';\nimport { serviceCreators } from '../common/service-factory';\n\nfunction registerServices() {\n  serviceCreators['ErrorLogging'] = function (serviceFactory) {\n    var _serviceFactory$getSe = serviceFactory.getService([APM_SERVER, CONFIG_SERVICE, 'TransactionService']),\n        apmServer = _serviceFactory$getSe[0],\n        configService = _serviceFactory$getSe[1],\n        transactionService = _serviceFactory$getSe[2];\n\n    return new ErrorLogging(apmServer, configService, transactionService);\n  };\n}\n\nexport { registerServices };","import { getInstrumentationFlags, PAGE_LOAD, ERROR, CONFIG_SERVICE, LOGGING_SERVICE, APM_SERVER } from '@elastic/apm-rum-core';\n\nvar ApmBase = function () {\n  function ApmBase(serviceFactory, disable) {\n    this._disable = disable;\n    this.serviceFactory = serviceFactory;\n    this._initialized = false;\n  }\n\n  var _proto = ApmBase.prototype;\n\n  _proto.isEnabled = function isEnabled() {\n    return !this._disable;\n  };\n\n  _proto.isActive = function isActive() {\n    var configService = this.serviceFactory.getService(CONFIG_SERVICE);\n    return this.isEnabled() && this._initialized && configService.get('active');\n  };\n\n  _proto.init = function init(config) {\n    var _this = this;\n\n    if (this.isEnabled() && !this._initialized) {\n      this._initialized = true;\n\n      var _this$serviceFactory$ = this.serviceFactory.getService([CONFIG_SERVICE, LOGGING_SERVICE]),\n          configService = _this$serviceFactory$[0],\n          loggingService = _this$serviceFactory$[1];\n\n      configService.setVersion('5.10.2');\n      this.config(config);\n      var logLevel = configService.get('logLevel');\n      loggingService.setLevel(logLevel);\n      var isConfigActive = configService.get('active');\n\n      if (isConfigActive) {\n        this.serviceFactory.init();\n        var flags = getInstrumentationFlags(configService.get('instrument'), configService.get('disableInstrumentations'));\n        var performanceMonitoring = this.serviceFactory.getService('PerformanceMonitoring');\n        performanceMonitoring.init(flags);\n\n        if (flags[ERROR]) {\n          var errorLogging = this.serviceFactory.getService('ErrorLogging');\n          errorLogging.registerListeners();\n        }\n\n        if (configService.get('session')) {\n          var localConfig = configService.getLocalConfig();\n\n          if (localConfig && localConfig.session) {\n            configService.setConfig({\n              session: localConfig.session\n            });\n          }\n        }\n\n        var sendPageLoad = function sendPageLoad() {\n          return flags[PAGE_LOAD] && _this._sendPageLoadMetrics();\n        };\n\n        if (configService.get('centralConfig')) {\n          this.fetchCentralConfig().then(sendPageLoad);\n        } else {\n          sendPageLoad();\n        }\n      } else {\n        this._disable = true;\n        loggingService.warn('RUM agent is inactive');\n      }\n    }\n\n    return this;\n  };\n\n  _proto.fetchCentralConfig = function fetchCentralConfig() {\n    var _this$serviceFactory$2 = this.serviceFactory.getService([APM_SERVER, LOGGING_SERVICE, CONFIG_SERVICE]),\n        apmServer = _this$serviceFactory$2[0],\n        loggingService = _this$serviceFactory$2[1],\n        configService = _this$serviceFactory$2[2];\n\n    return apmServer.fetchConfig(configService.get('serviceName'), configService.get('environment')).then(function (config) {\n      var transactionSampleRate = config['transaction_sample_rate'];\n\n      if (transactionSampleRate) {\n        transactionSampleRate = Number(transactionSampleRate);\n        var _config2 = {\n          transactionSampleRate: transactionSampleRate\n        };\n\n        var _configService$valida = configService.validate(_config2),\n            invalid = _configService$valida.invalid;\n\n        if (invalid.length === 0) {\n          configService.setConfig(_config2);\n        } else {\n          var _invalid$ = invalid[0],\n              key = _invalid$.key,\n              value = _invalid$.value,\n              allowed = _invalid$.allowed;\n          loggingService.warn(\"invalid value \\\"\" + value + \"\\\" for \" + key + \". Allowed: \" + allowed + \".\");\n        }\n      }\n\n      return config;\n    }).catch(function (error) {\n      loggingService.warn('failed fetching config:', error);\n    });\n  };\n\n  _proto._sendPageLoadMetrics = function _sendPageLoadMetrics() {\n    var tr = this.startTransaction(undefined, PAGE_LOAD, {\n      managed: true,\n      canReuse: true\n    });\n\n    if (!tr) {\n      return;\n    }\n\n    tr.addTask(PAGE_LOAD);\n\n    var sendPageLoadMetrics = function sendPageLoadMetrics() {\n      setTimeout(function () {\n        return tr.removeTask(PAGE_LOAD);\n      });\n    };\n\n    if (document.readyState === 'complete') {\n      sendPageLoadMetrics();\n    } else {\n      window.addEventListener('load', sendPageLoadMetrics);\n    }\n  };\n\n  _proto.observe = function observe(name, fn) {\n    var configService = this.serviceFactory.getService(CONFIG_SERVICE);\n    configService.events.observe(name, fn);\n  };\n\n  _proto.config = function config(_config) {\n    var configService = this.serviceFactory.getService(CONFIG_SERVICE);\n\n    var _configService$valida2 = configService.validate(_config),\n        missing = _configService$valida2.missing,\n        invalid = _configService$valida2.invalid;\n\n    if (missing.length === 0 && invalid.length === 0) {\n      configService.setConfig(_config);\n    } else {\n      var loggingService = this.serviceFactory.getService(LOGGING_SERVICE);\n      var separator = ', ';\n      var message = \"RUM agent isn't correctly configured. \";\n\n      if (missing.length > 0) {\n        message += missing.join(separator) + ' is missing';\n\n        if (invalid.length > 0) {\n          message += separator;\n        }\n      }\n\n      invalid.forEach(function (_ref, index) {\n        var key = _ref.key,\n            value = _ref.value,\n            allowed = _ref.allowed;\n        message += key + \" \\\"\" + value + \"\\\" contains invalid characters! (allowed: \" + allowed + \")\" + (index !== invalid.length - 1 ? separator : '');\n      });\n      loggingService.error(message);\n      configService.setConfig({\n        active: false\n      });\n    }\n  };\n\n  _proto.setUserContext = function setUserContext(userContext) {\n    var configService = this.serviceFactory.getService(CONFIG_SERVICE);\n    configService.setUserContext(userContext);\n  };\n\n  _proto.setCustomContext = function setCustomContext(customContext) {\n    var configService = this.serviceFactory.getService(CONFIG_SERVICE);\n    configService.setCustomContext(customContext);\n  };\n\n  _proto.addLabels = function addLabels(labels) {\n    var configService = this.serviceFactory.getService(CONFIG_SERVICE);\n    configService.addLabels(labels);\n  };\n\n  _proto.setInitialPageLoadName = function setInitialPageLoadName(name) {\n    var configService = this.serviceFactory.getService(CONFIG_SERVICE);\n    configService.setConfig({\n      pageLoadTransactionName: name\n    });\n  };\n\n  _proto.startTransaction = function startTransaction(name, type, options) {\n    if (this.isEnabled()) {\n      var transactionService = this.serviceFactory.getService('TransactionService');\n      return transactionService.startTransaction(name, type, options);\n    }\n  };\n\n  _proto.startSpan = function startSpan(name, type, options) {\n    if (this.isEnabled()) {\n      var transactionService = this.serviceFactory.getService('TransactionService');\n      return transactionService.startSpan(name, type, options);\n    }\n  };\n\n  _proto.getCurrentTransaction = function getCurrentTransaction() {\n    if (this.isEnabled()) {\n      var transactionService = this.serviceFactory.getService('TransactionService');\n      return transactionService.getCurrentTransaction();\n    }\n  };\n\n  _proto.captureError = function captureError(error) {\n    if (this.isEnabled()) {\n      var errorLogging = this.serviceFactory.getService('ErrorLogging');\n      return errorLogging.logError(error);\n    }\n  };\n\n  _proto.addFilter = function addFilter(fn) {\n    var configService = this.serviceFactory.getService(CONFIG_SERVICE);\n    configService.addFilter(fn);\n  };\n\n  return ApmBase;\n}();\n\nexport { ApmBase as default };","import { XMLHTTPREQUEST, FETCH, HISTORY, PAGE_LOAD, ERROR, EVENT_TARGET } from './constants';\nexport function getInstrumentationFlags(instrument, disabledInstrumentations) {\n  var _flags;\n\n  var flags = (_flags = {}, _flags[XMLHTTPREQUEST] = false, _flags[FETCH] = false, _flags[HISTORY] = false, _flags[PAGE_LOAD] = false, _flags[ERROR] = false, _flags[EVENT_TARGET] = false, _flags);\n\n  if (!instrument) {\n    return flags;\n  }\n\n  Object.keys(flags).forEach(function (key) {\n    if (disabledInstrumentations.indexOf(key) === -1) {\n      flags[key] = true;\n    }\n  });\n  return flags;\n}","import { createServiceFactory, bootstrap, isBrowser } from '@elastic/apm-rum-core';\nimport ApmBase from './apm-base';\n\nfunction getApmBase() {\n  if (isBrowser && window.elasticApm) {\n    return window.elasticApm;\n  }\n\n  var enabled = bootstrap();\n  var serviceFactory = createServiceFactory();\n  var apmBase = new ApmBase(serviceFactory, !enabled);\n\n  if (isBrowser) {\n    window.elasticApm = apmBase;\n  }\n\n  return apmBase;\n}\n\nvar apmBase = getApmBase();\nvar init = apmBase.init.bind(apmBase);\nexport default init;\nexport { init, apmBase, ApmBase, apmBase as apm };","const elasticApm = require('@elastic/apm-rum')\n\nelasticApm.init({\n    serverUrl: 'https://kibana-ops-e2e-perf.apm.us-central1.gcp.cloud.es.io:443',\n    serviceName: 'sanity-check',\n    environment: 'development'\n})"],"names":["factory","module","exports","_isNumber","n","isNaN","parseFloat","isFinite","StackFrame","functionName","args","fileName","lineNumber","columnNumber","source","undefined","this","setFunctionName","setArgs","setFileName","setLineNumber","setColumnNumber","setSource","prototype","getFunctionName","v","String","getArgs","Object","toString","call","TypeError","getFileName","getLineNumber","Number","getColumnNumber","getSource","join","define","amd","$249eb9260e1d4a34$export$8c8855196b9f04f8","errorEvent","error","filename","lineno","colno","stackTraces","$parcel$interopDefault","$d0534260f665629a$exports","parse","e","length","map","frame","fnName","parts","split","replace","stack","_stack$functionName","fileUrl","origin","filePath","$249eb9260e1d4a34$var$cleanFilePath","cleanedFileName","window","location","protocol","hostname","port","indexOf","href","$249eb9260e1d4a34$var$isFileInline","abs_path","function","FIREFOX_SAFARI_STACK_REGEXP","CHROME_IE_STACK_REGEXP","SAFARI_NATIVE_CODE_REGEXP","_map","array","fn","thisArg","Array","output","i","_filter","filter","push","stacktrace","parseOpera","match","parseV8OrIE","parseFFOrSafari","Error","extractLocation","urlLike","exec","line","tokens","slice","locationParts","pop","target","_indexOf","message","parseOpera9","parseOpera11","parseOpera10","lineRE","lines","result","len","argsRaw","functionCall","shift","parcelRequire","$e86ec1941a88c97e$export$2e2bcd8739ae039","callback","constructor","then","value","resolve","reason","reject","$aae11a54844710ec$export$2e2bcd8739ae039","arr","remaining","res","val1","val","status","i1","$95f3b82b2127a3ee$var$setTimeoutFunc","setTimeout","$95f3b82b2127a3ee$var$isArray","x","Boolean","$95f3b82b2127a3ee$var$noop","$95f3b82b2127a3ee$var$Promise","_state","_handled","_value","_deferreds","$95f3b82b2127a3ee$var$doResolve","$95f3b82b2127a3ee$var$handle","self","deferred","_immediateFn","cb","onFulfilled","onRejected","ret","$95f3b82b2127a3ee$var$reject","promise","$95f3b82b2127a3ee$var$resolve","newValue","$95f3b82b2127a3ee$var$finale","apply","arguments","_unhandledRejectionFn","$95f3b82b2127a3ee$var$Handler","done","ex","prom","all","allSettled","race","setImmediate","err","console","warn","$95f3b82b2127a3ee$export$2e2bcd8739ae039","$787e1a15c5851890$var$local","$4336da1df7cce5bd$export$4e09c449d6c407f7","$787e1a15c5851890$export$775f0de60169233c","Promise","$4336da1df7cce5bd$var$slice","$4336da1df7cce5bd$export$20dfe5c0db9ba10","performance","$4336da1df7cce5bd$var$byteToHex","$4336da1df7cce5bd$var$i","substr","$4336da1df7cce5bd$var$destination","Uint8Array","$4336da1df7cce5bd$export$59b2544ec352d56","buffer","hexOctets","_i","$4336da1df7cce5bd$export$58b867e287a802c8","crypto","getRandomValues","msCrypto","$4336da1df7cce5bd$export$4a0dedceb084213c","name","setRequestHeader","headers","append","$4336da1df7cce5bd$export$8731073ee4364c34","isSame","test","isArray","forEach","t","$4336da1df7cce5bd$export$69a8fd7b83cf9f89","Set","JSON","stringify","now","XMLHttpRequest","$4336da1df7cce5bd$export$4f65e594f6031297","key","obj","skey","$4336da1df7cce5bd$export$fbffb0ac2c2ec159","valueType","$4336da1df7cce5bd$export$b3289ee923920b2a","url","$4336da1df7cce5bd$export$a6cdc56e425d0d0a","$4336da1df7cce5bd$export$bf6cb145536e8bab","dst","objs","deep","ii","keys","j","jj","src","$4336da1df7cce5bd$export$8fc24885882b6ead","document","currentScript","scripts","getElementsByTagName","l","sc","$4336da1df7cce5bd$export$bf6fdd3c8902f077","$4336da1df7cce5bd$export$8b58be045bf06082","$4336da1df7cce5bd$export$4950aa0f605343fb","$4336da1df7cce5bd$export$fce6876652108ab","$4336da1df7cce5bd$export$8793edee2d425525","$4336da1df7cce5bd$export$461939dd4422153","$4336da1df7cce5bd$export$1428f42a7de81803","time","$4336da1df7cce5bd$export$75bba95db5c3e753","start","end","parseInt","$4336da1df7cce5bd$export$3262a5e6cc4c389e","$4336da1df7cce5bd$export$475e1d086d647d28","getEntriesByType","$4336da1df7cce5bd$export$c043ff66aa95c00c","type","PerformanceObserver","supportedEntryTypes","$ec0b2ea3826b1056$var$RULES","NaN","$ec0b2ea3826b1056$var$PROTOCOL_REGEX","$ec0b2ea3826b1056$export$59d795186a5d3f58","index","_this$extractProtocol","extractProtocol","address","slashes","relative","getLocation","instructions","instruction","instLength","newIndex","lastIndexOf","Math","max","toLowerCase","path","charAt","host","$ec0b2ea3826b1056$var$isDefaultPort","_proto","auth","REDACTED","userpass","query","hash","globalVar","$910faad2fdd3508c$export$fcac77ffb8211a1f","$910faad2fdd3508c$export$38ee95dde3859fb7","$7f16692931a73406$var$_excluded","$7f16692931a73406$var$getResponseContext","perfTimingEntry","respContext","transfer_size","transferSize","encoded_body_size","encodedBodySize","decoded_body_size","decodedBodySize","serverTimingStr","serverTimingEntries","serverTimingInfo","_i2","_serverTimingEntries$","duration","description","timingValue","valueSeparator","$4336da1df7cce5bd$export$11b3928e177dda19","serverTiming","$7f16692931a73406$var$getDestination","parsedUrl","portNumber","$7f16692931a73406$var$getPortNumber","ipv6Hostname","charCodeAt","service","resource","$7f16692931a73406$export$1303843c2f44065a","page","referer","referrer","$7f16692931a73406$export$ed109afa225aed5b","span","data","context","statusCode","method","response","destination","http","status_code","$7f16692931a73406$var$getExternalContext","entry","$7f16692931a73406$var$getResourceContext","$7f16692931a73406$var$getNavigationContext","addContext","$7f16692931a73406$export$d10ae57e760667a5","transaction","_temp","_ref","configContext","tags","excluded","sourceKeys","$7f16692931a73406$var$_objectWithoutPropertiesLoose","pageContext","responseContext","entries","$77bc90f82ae41bfe$export$cddc53a868778b3a","version","agent","environment","labels","$77bc90f82ae41bfe$export$a92fd7a0c1236a31","$77bc90f82ae41bfe$var$CONTEXT_MODEL","user","id","email","username","$77bc90f82ae41bfe$export$41c959b800170f79","trace_id","parent_id","transaction_id","subtype","action","$77bc90f82ae41bfe$export$d887b343e3ec3a69","span_count","started","$77bc90f82ae41bfe$export$fdad63db1c0e037c","culprit","exception","$77bc90f82ae41bfe$var$isEmpty","$77bc90f82ae41bfe$var$replaceValue","currModel","limit","required","placeholder","substring","$77bc90f82ae41bfe$export$6a506b36fdea397d","$77bc90f82ae41bfe$export$488247de36c98c6b","model","childTarget","emptyArr","_loop","currKey","$eeb931ae566e8e99$var$_excluded","$eeb931ae566e8e99$var$IGNORE_KEYS","$eeb931ae566e8e99$export$2e2bcd8739ae039","ErrorLogging","apmServer","configService","transactionService","_apmServer","_configService","_transactionService","createErrorDataModel","filteredFrames","frames","$249eb9260e1d4a34$export$388e43ae04f18461","lastFrame","errorMessage","errorType","errorContext","customProperties","propertyFound","properties","toISOString","$eeb931ae566e8e99$var$getErrorProperties","custom","currentTransaction","getCurrentTransaction","transactionContext","_this$_configService$","get","$eeb931ae566e8e99$var$_objectWithoutPropertiesLoose","errorObject","traceId","sampled","logErrorEvent","addError","registerListeners","_this","addEventListener","promiseRejectionEvent","logPromiseEvent","prefix","logError","messageOrError","$b30005d541c78cc7$export$2e2bcd8739ae039","Queue","onFlush","opts","items","queueLimit","flushInterval","timeoutId","_setTimer","flush","_clear","clearTimeout","add","item","$1dc2364fe11ecc9e$export$2e2bcd8739ae039","NDJSON","object","$94a43e5a182015b0$export$8e769ad4338a911e","fetchInProgress","$94a43e5a182015b0$export$652b0f25a523f48f","$94a43e5a182015b0$export$27a263d91197d790","patchFn","proto","hasOwnProperty","getPrototypeOf","delegate","patched","original","propertyDesc","delegateName","desc","getOwnPropertyDescriptor","writable","set","patchDelegate","$94a43e5a182015b0$export$1d2facecfc1955cc","$94a43e5a182015b0$export$bda265647bf75488","$94a43e5a182015b0$export$9a7ca3b2c2e97bd9","$94a43e5a182015b0$export$90db053605542d02","$1b74086ccbb258b0$export$2e2bcd8739ae039","SpanBase","options","sampleRate","timestamp","_start","startTime","_end","ended","outcome","onEnd","ensureContext","addLabels","ctx","k","_len","_key","concat","endTime","callOnEnd","$fe5857eb8ef052b5$var$_setPrototypeOf","o1","p1","setPrototypeOf","o","p","__proto__","$fe5857eb8ef052b5$export$2e2bcd8739ae039","_SpanBase","subClass","superClass","Span","parentId","fields","sync","create","$4830d62025528325$export$ca000e230c0caa3e","bootstrapTime","lastHiddenStart","MIN_SAFE_INTEGER","$59fe259a0fb2d6e9$var$eventPairs","$59fe259a0fb2d6e9$var$shouldCreateSpan","trStart","trEnd","baseTime","$59fe259a0fb2d6e9$var$createResourceTimingSpan","resourceTimingEntry","initiatorType","responseEnd","kind","spanName","$59fe259a0fb2d6e9$var$isCapturedByPatching","resourceStartTime","requestPatchTime","$59fe259a0fb2d6e9$export$76056912abddbcc9","$59fe259a0fb2d6e9$export$82a807639806d09d","$59fe259a0fb2d6e9$export$f010c0904d0d2983","timing","marks","fetchStart","navigationStart","responseStart","timingKey","m","$59fe259a0fb2d6e9$var$getNavigationTimingMarks","navigationTiming","timeToFirstByte","domInteractive","domComplete","$59fe259a0fb2d6e9$export$ffbf565d212a6a74","captureTimings","customMarks","timings","spans","pageResponse","$59fe259a0fb2d6e9$export$3f88cb87ead13585","pageLoadSpanId","addMarks","_trStart","_entries$i","$59fe259a0fb2d6e9$export$c7038f2b5602881b","userTimingSpans","_entries$i2","$59fe259a0fb2d6e9$export$d31d86bf4b796a11","$56e3432e299bdac7$var$compressResponse","ts","ebs","dbs","$56e3432e299bdac7$var$compressContext","compressed","rf","h","mt","r","$56e3432e299bdac7$var$compressHTTP","dt","se","rc","ad","po","u","un","em","cu","$56e3432e299bdac7$var$compressMarks","compressedNtMarks","ntMarks","mark","mapping","$56e3432e299bdac7$var$compressNavigationTimingMarks","nt","a","$56e3432e299bdac7$var$compressAgentMarks","agentMarks","fb","rs","di","dc","fp","firstContentfulPaint","lp","largestContentfulPaint","$9a9c011cebb58d72$export$2e2bcd8739ae039","ApmServer","loggingService","_loggingService","queue","throttleEvents","init","events","sendEvents","catch","_constructError","onThrottle","interval","counter","$345fe5f8b87ce6d1$export$2e2bcd8739ae039","bind","_postJson","endPoint","payload","_this2","params","beforeSend","isCompressionStreamSupported","CompressionStream","payload1","compressedStream","Blob","stream","pipeThrough","Response","blob","$56e3432e299bdac7$export$5569fdd03c217956","_makeHttpRequest","responseText","_ref2","_ref2$timeout","timeout","xhr","open","header","onreadystatechange","readyState","onerror","canSend","send","fetchConfig","serviceName","_this3","configEndpoint","localConfig","getLocalConfig","etag","apmRequest","remoteConfig","getResponseHeader","setLocalConfig","createMetaData","cfg","metadata","language","_this$throttleEvents","addTransaction","_this$throttleEvents2","ndjsonErrors","errors","compress","_NDJSON$stringify","cl","mg","st","ap","f","li","co","c","tid","pid","xid","sm","$56e3432e299bdac7$export$c8289256501a337d","ndjsonMetricsets","metricsets","metricset","ndjsonTransactions","transactions","_this4","tr","_NDJSON$stringify2","breakdowns","breakdown","spanData","s","d","sr","sample_rate","sy","su","ac","me","samples","y","sa","ysc","yss","xdc","xds","xbc","yc","sd","experience","_transaction$experien","cls","fid","tbt","longtask","exp","lt","session","_transaction$session","sequence","ses","seq","$56e3432e299bdac7$export$2113d87e265597f0","_payload","_NDJSON$stringify3","event","filteredPayload","applyFilters","apiVersion","ndjson","metadataKey","ve","la","en","$56e3432e299bdac7$export$12b7560e2fabea9","ndjsonPayload","serverUrlPrefix","$dc1e28867f9b3a7d$export$2e2bcd8739ae039","EventHandler","observers","observe","splice","sendOnly","obs","log","$40893dbc8936fb80$var$_extends","assign","$fac52b7c63faf74d$var$_serviceCreators","$40893dbc8936fb80$export$2e2bcd8739ae039","Config","config","serviceVersion","serverUrl","active","instrument","disableInstrumentations","logLevel","breakdownMetrics","ignoreTransactions","eventsLimit","distributedTracing","distributedTracingOrigins","distributedTracingHeaderName","pageLoadTraceId","pageLoadSampled","pageLoadTransactionName","propagateTracestate","transactionSampleRate","centralConfig","monitorLongtasks","filters","scriptData","node","dataAttrs","dataRegex","attrs","attributes","attr","nodeName","toUpperCase","nodeValue","$40893dbc8936fb80$var$getDataAttributesFromNode","setConfig","setVersion","addFilter","reduce","objKey","setUserContext","userContext","_userContext","setCustomContext","customContext","_properties","round","validate","requiredKeys","missing","invalid","allowed","storage","sessionStorage","localStorage","getItem","merge","setItem","$094dca2c088c3a8e$export$2e2bcd8739ae039","LoggingService","spec","levels","level","resetLogMethods","shouldLog","setLevel","normalizedLevel","realMethod","$fac52b7c63faf74d$export$a7d9bc765837b75c","_factory$getService","getService","$fac52b7c63faf74d$export$654036ce31f352db","instances","initialized","_this$getService","$3257b72fe7eaa68d$export$41ed32b4ed20742","XMLHttpRequestPrototype","READY_STATE_CHANGE","LOAD","ERROR","openNative","sendNative","task","state","addListener","invokeTask","scheduleTask","$acd7a4da3be2cb6d$var$eventTypes","$acd7a4da3be2cb6d$var$eventTypeSymbols","$acd7a4da3be2cb6d$var$i","$acd7a4da3be2cb6d$var$et","$acd7a4da3be2cb6d$var$shouldInstrumentEvent","eventType","listenerFn","EventTarget","$719e3450a6ddaeef$export$602cc6306ec009d8","$719e3450a6ddaeef$var$alreadyPatched","$719e3450a6ddaeef$export$94da54533f7f9289","fetch","Request","nativeFetch","input","request","fetchSelf","aborted","error1","$f2215a2197d7d00b$export$28f71c1f202028d4","history","nativePushState","pushState","title","$c5039cacea1bcecd$export$1c3c71cac9d1d555","nativeAddEventListener","nativeRemoveEventListener","optionsOrCapture","wrappingListenerFn","createListenerWrapper","wrappingFn","getWrappingFn","findTaskIndex","existingTasks","capture","isCapture","eventSymbol","taskIndex","$acd7a4da3be2cb6d$export$6cc42796eab5a2da","$c5e6dd75fc47022d$export$2e2bcd8739ae039","_logginService","flags","$910faad2fdd3508c$export$3583e51eacab0340","createTransactionPayload","getHistorySub","getXHRSub","getFetchSub","getEventTargetSub","tagName","transactionName","dataset","getAttribute","startTransaction","managed","canReuse","reuseThreshold","classes","processAPICalls","requestUrl","startSpan","blocking","isDtEnabled","dtOrigins","currentUrl","isSameOrigin","injectDtHeader","injectTSHeader","_data","_span","_target","endSpan","headerName","headerValue","dtVersion","$4336da1df7cce5bd$export$312052e2a8d615c6","$4336da1df7cce5bd$export$6fbffd43bfec7ed8","extractDtHeader","parsed","$4336da1df7cce5bd$export$86a08f9fd706a6b8","filterTransaction","isManaged","createTransactionDataModel","transactionStart","transactionData","breakdownTimings","adjustedTransaction","filterdSpans","similarSpans","originalSpans","transDuration","threshold","sort","spanA","spanB","lastCount","lastSpan","isContinuouslySimilar","isLastSpan","$c5e6dd75fc47022d$export$82a182639eda9ace","resetFields","$c5e6dd75fc47022d$export$e5fabcf37bedf526","$fce096c3f0df0960$var$pageLoadBreakdowns","$fce096c3f0df0960$var$getValue","$fce096c3f0df0960$var$getSpanBreakdown","transactionDetails","details","_ref$count","count","$b4ad6efbf1cb6266$var$_setPrototypeOf","$b4ad6efbf1cb6266$export$2e2bcd8739ae039","Transaction","_activeSpans","_activeTasks","blocked","random","markTime","redefine","trc","_onSpanEnd","addTask","isFinished","size","detectFinish","sid","captureBreakdown","trDuration","type1","current","spanMap","transactionSelfTime","span1","span2","spanEnd","spanStart","lastContinuousEnd","selfTime","$fce096c3f0df0960$var$calculateSelfTime","$fce096c3f0df0960$var$groupSpans","_key$split","_spanMap$key","$fce096c3f0df0960$export$f29e26af65381f57","block","flag","taskId","removeTask","delete","$ebbb2e7aefdc9d7b$export$b0c5c2fac8144e54","fcp","Infinity","score","firstEntryTime","NEGATIVE_INFINITY","prevEntryTime","currentSessionScore","$ebbb2e7aefdc9d7b$export$9042c3a3f5ee2ee","list","isHardNavigation","longtaskEntries","longtasks","agg","_longtasks$i","attribution","_attribution$","_name","containerType","containerName","containerId","$ebbb2e7aefdc9d7b$export$2bed7abe701121db","lcpEntries","lastLcpEntry","lcp","unloadDiff","fcpEntry","getEntriesByName","fidSpan","fidEntries","firstInput","processingStart","$ebbb2e7aefdc9d7b$export$dbb9abd64c7ad2de","min","blockingTime","$ebbb2e7aefdc9d7b$export$cdc3b71aeb75f979","clsEntries","hadRecentInput","$ebbb2e7aefdc9d7b$export$1ee9edc2f05fc2c0","$ebbb2e7aefdc9d7b$export$e105e1823c980668","disconnect","buffered","_","stop","$3ef25f3db5edc06f$export$2e2bcd8739ae039","TransactionService","logger","_config","_logger","respIntervalId","recorder","_tr$spans","_captureObserverEntri","createCurrentTransaction","createOptions","perfOptions","startManagedTransaction","isRedefined","redefineType","currentTypeOrder","redefineTypeOrder","fireOnstartHook","handleTransactionEnd","shouldIgnoreTransaction","tbtObject","tbtSpan","sum","setSession","urlStr","depth","pathParts","redactString","specialCharsRegex","digitsRegex","lowerCaseRegex","upperCaseRegex","redactedParts","redactedBefore","part","numberOfDigits","numberofUpperCase","lowerCaseRate","upperCaseRate","$ec0b2ea3826b1056$export$456a5af62e4119f6","adjustTransactionTime","Date","sessionConfig","earliestSpan","_i4","$4336da1df7cce5bd$export$26335e41fd84043b","latestSpan","_i3","$4336da1df7cce5bd$export$4066158e069099c5","transactionEnd","ignoreList","element","$e7ee34a08d615f9e$var$enabled","$e7ee34a08d615f9e$export$36aff1fbb4f5dfc6","visibilityState","$e7ee34a08d615f9e$export$bf7c39c3f9ae0285","$5877a25a5ce52c3e$export$791d8bdb130abda4","serviceFactory","_serviceFactory$getSe","_serviceFactory$getSe2","$a81fb25abcc15ec1$export$2e2bcd8739ae039","disable","_disable","_initialized","isEnabled","isActive","_this$serviceFactory$","disabledInstrumentations","_flags","$f1d37b24f6de347d$export$7852da8de47c1ce0","sendPageLoad","_sendPageLoadMetrics","fetchCentralConfig","_this$serviceFactory$2","_config2","_invalid$","sendPageLoadMetrics","_configService$valida2","separator","setInitialPageLoadName","captureError","$6756f4b2093f4254$export$66cd81c234b843ce","elasticApm","enabled","$6756f4b2093f4254$var$getApmBase","$6756f4b2093f4254$export$2cd8252107eb640b"],"version":3,"file":"index.a050bb4b.js.map"}